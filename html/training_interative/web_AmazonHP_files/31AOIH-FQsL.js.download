'use strict';mix_d("PVEARecommendationsCardsSources__video-player:video-player__DsKDyOo8","exports tslib @c/metrics @c/scoped-dom @c/logger @c/dom @c/pagemarker @p/p-detect @c/aui-utils @p/gw-video-orchestrator".split(" "),function(x,y,p,F,z,u,G,H,I,J){function k(a){return a&&"object"===typeof a&&"default"in a?a:{"default":a}}var h=k(F),A=k(u),K=k(G),L=k(H),B=k(I),m=k(J),f={pveaVideoPlayer:"_video-player_video-card_pvea-video-player__QGegF",pveaVideoIcon:"_video-player_video-card_pvea-video-icon__HuFnn",
pveaVideoSvg:"_video-player_video-card_pvea-video-svg__2Vxjh",pveaVideoLoad:"_video-player_video-card_pvea-video-load__3Z_sK",pveaSpinner:"_video-player_video-card_pvea-spinner__8Mzpc",pveaVideoCenterControls:"_video-player_video-card_pvea-video-center-controls__Gbfbb",pveaVideoVolumeControls:"_video-player_video-card_pvea-video-volume-controls__2KUsN",pveaVideoContainer:"_video-player_video-card_pvea-video-container__2B81g",pveaVideoOverlay:"_video-player_video-card_pvea-video-overlay__3Gxyj",pveaVideoImgContainer:"_video-player_video-card_pvea-video-img-container__3g_eU",
pveaVideoImg:"_video-player_video-card_pvea-video-img__5JGIQ",pveaVideoScrim:"_video-player_video-card_pvea-video-scrim__2eHLd",pveaVideoMessageContainer:"_video-player_video-card_pvea-video-message-container__d5EjB",pveaVideoEndSlate:"_video-player_video-card_pvea-video-end-slate__204rH",pveaTransitionNone:"_video-player_video-card_pvea-transition-none__ZMUyl",pveaVideoTransparent:"_video-player_video-card_pvea-video-transparent__2G5qn",pveaVideoHide:"_video-player_video-card_pvea-video-hide__2SSG0",
pveaVideoLoading:"_video-player_video-card_pvea-video-loading__q1XAa",pveaVideoLink:"_video-player_video-card_pvea-video-link__2K-Xe",pveaVideoPlay:"_video-player_video-card_pvea-video-play__1BuWc",pveaVideoPause:"_video-player_video-card_pvea-video-pause__1GVMB",pveaVideoFooter:"_video-player_video-card_pvea-video-footer__1xcp8",pveaVideoMessageText:"_video-player_video-card_pvea-video-message-text__3E-36",pveaVideoTouched:"_video-player_video-card_pvea-video-touched__1p0R_",pveaVideoFallback:"_video-player_video-card_pvea-video-fallback__3TqU-",
pveaVideoFallbackInner:"_video-player_video-card_pvea-video-fallback-inner__2-Gto"},q;(function(a){a[a.MEDIA_ERR_ABORTED=1]="MEDIA_ERR_ABORTED";a[a.MEDIA_ERR_NETWORK=2]="MEDIA_ERR_NETWORK";a[a.MEDIA_ERR_DECODE=3]="MEDIA_ERR_DECODE";a[a.MEDIA_ERR_SRC_NOT_SUPPORTED=4]="MEDIA_ERR_SRC_NOT_SUPPORTED"})(q||(q={}));var C=function(a,c){c.dataset.item&&c.dataset.request&&(c=c.dataset,a={event:a,itemId:c.item,itemType:c.itemtype,mediaType:c.mediatype,requestId:c.request},"function"===typeof window.ue.event&&
window.ue.event(a,"ces-online","PVEA.OnlineClientEvent.3"))},D=function(a,c){"function"===typeof z.log&&z.log(a,c,"PVEA.HUD-VIDEO")},M="play playing pause ended volumechange error canplay canplaythrough waiting timeupdate".split(" "),E=function(a){var c=a.video,e={},d=function(a,b){(a=e[a])&&a.forEach(function(a){return a(b)})},b=function(a,b){e[a]||(e[a]=[]);e[a].push(b)},f=function(a,b){e[a]&&(e[a]=e[a].filter(function(a){return a!==b}))},l=function(a,b,c){b.addEventListener(a,c)},g=function(a,
b){l(a,b,function(b){d(a,b)})};c&&M.forEach(function(a){return g(a,c)});return{publish:d,subscribe:b,unsubscribe:f,once:function(a,c){var d=function(b){c(b);f(a,d)};b(a,d)},bindDomEvent:l,onClick:function(a,b){a.addEventListener("click",b)},onTouchStart:function(a,b){a.addEventListener("touchstart",b)},onTouchEnd:function(a,b){a.addEventListener("touchend",b)}}},N=function(a,c){var e={cardLink:A["default"].cardRoot.getElementsByClassName("pvea-static-card-link")[0],ctaLink:A["default"].cardRoot.getElementsByClassName("pvea-static-card-cta")[0]};
c=E(e);c.onClick(e.cardLink,function(){return a("CLICK",e.cardLink)});c.onClick(e.ctaLink,function(){return a("CTA_CLICK",e.ctaLink)});a("VISIBLE",e.cardLink)},O=function(a,c,e){c.subscribe("error",function(){if(a.error){var d=a.error,b=d instanceof MediaError&&d.code&&q[d.code];d instanceof MediaError&&(b&&Object.assign(d,{mediaErrorName:b}),b={error:d,message:"We're having trouble playing this video.",recoverable:[1,2].includes(d.code)},c.publish("handledMediaError",b));e(d.message,"FATAL")}})},
g;(function(a){a.VIDEO_VISIBLE="VIDEO_VISIBLE";a.FIRST_QUARTILE="FIRST_QUARTILE";a.HALF="HALF";a.THIRD_QUARTILE="THIRD_QUARTILE";a.COMPLETE="COMPLETE";a.MUTE="MUTE";a.UNMUTE="UNMUTE";a.PLAY="PLAY";a.PAUSE="PAUSE";a.PLAY_CLICKED="PLAY_CLICKED";a.PAUSE_CLICKED="PAUSE_CLICKED";a.CTA_CLICK="CTA_CLICK";a.END_SLATE_CLICK="END_SLATE_CLICK";a.END_SLATE_VISIBLE="END_SLATE_VISIBLE"})(g||(g={}));var P=function(a,c){var e=function(b){"undefined"!==typeof b&&b.target&&(b=b.target,c.unsubscribe("showEndSlate",
e),a(g.END_SLATE_VISIBLE,b))},d=function(b){"undefined"!==typeof b&&b.target&&(a(g.VIDEO_VISIBLE,b.target),c.unsubscribe("videoVisible",d))};return{onCtaClick:function(){var b=h["default"].cardRoot.getElementsByClassName(f.pveaVideoPlayer)[0];a(g.CTA_CLICK,b)},onEndSlateClick:function(b){a(g.END_SLATE_CLICK,b.target)},onEndSlateVisible:e,onPause:function(b){a(g.PAUSE,b.target)},onPauseButtonClick:function(b){a(g.PAUSE_CLICKED,b.target)},onPlay:function(b){b=b.target;p.count("PV.HUD-Video.play",1);
a(g.PLAY,b)},onPlayButtonClick:function(b){a(g.PLAY_CLICKED,b.target)},onTimeUpdate:function(b){b=b.target;var c=Math.floor(.25*b.duration);if(0<c){var d=Math.floor(b.currentTime);d===c?a(g.FIRST_QUARTILE,b):d===2*c?a(g.HALF,b):d===3*c?a(g.THIRD_QUARTILE,b):b.currentTime===b.duration&&(p.count("PV.HUD-Video.videoCompleted",1),a(g.COMPLETE,b))}},onVideoVisible:d,onVolumeChange:function(b){b=b.target;b.muted?a(g.MUTE,b):b.muted||a(g.UNMUTE,b)}}},Q=function(a,c){c=P(c,a);a.subscribe("timeupdate",B["default"].throttle(c.onTimeUpdate,
1E3));a.subscribe("volumechange",c.onVolumeChange);a.subscribe("play",c.onPlay);a.subscribe("pause",c.onPause);a.subscribe("playClick",c.onPlayButtonClick);a.subscribe("pauseClick",c.onPauseButtonClick);a.subscribe("ctaClick",c.onCtaClick);a.subscribe("clickEndSlate",c.onEndSlateClick);a.subscribe("showEndSlate",c.onEndSlateVisible);a.subscribe("videoVisible",c.onVideoVisible)},R=function(a,c){var e=a.video,d=a.messageContainer,b=a.messageText;a=c.subscribe;var f=c.once,l=c.publish,g=null,h=function(){g&&
(d.classList.add("pveaVideoHide"),g=b.textContent=null,l("messageCleared"))},k=function(a){b.innerHTML=a;d.classList.remove("pveaVideoHide");g=a;l("messageDisplayed");f("canplaythrough",h)};a("handledMediaError",function(a){if((a=a.message)&&0<e.currentTime)switch(e.readyState){case 0:case 1:case 2:k(a);break;case 3:navigator.onLine||k(a)}})},S=function(a,c){var e=a.video,d=a.overlay,b=a.playIcon,g=a.pauseIcon;a=c.subscribe;var l=c.publish;c=c.onClick;var h=function(){g.classList.add(f.pveaVideoHide);
b.classList.remove(f.pveaVideoHide)},k=function(){b.classList.add(f.pveaVideoHide);g.classList.remove(f.pveaVideoHide)};a("play",k);a("pause",h);c(d,function(){e.paused?(l("playedByUser",{target:e}),k()):(l("pausedByUser",{target:e}),h())})},r,n=function(a){return!(!(a&&0<a.currentTime&&2<a.readyState)||a.paused||a.ended)},v=function(a){n(a)||(r=a&&a.play())},w=function(a){n(a)&&(r&&"function"===typeof r.then?r.then(function(){return a.pause()}):a.pause())},T=function(a,c){var e=a.endSlate,d=a.video,
b=c.publish;a=c.subscribe;a("ended",function(a){n(d)||(b("showEndSlate",a),e.classList.remove(f.pveaVideoTransparent),e.classList.remove("pveaVideoTransparent"))});a("play",function(){e.classList.add(f.pveaVideoTransparent)});e.addEventListener("click",function(a){b("clickEndSlate",a)})},U=function(a,c){var e=a.video,d=a.overlay,b=c.subscribe,g=c.onClick,h=c.onTouchEnd,k=c.publish;a=u.unscope(a.redirectLink);var m=B["default"].delay,r,n,p,q=function(){d.classList.add(f.pveaVideoHide)};c=function(){d.classList.remove(f.pveaVideoHide)};
var t=function(){d.classList.contains(f.pveaVideoLoading)&&(d.classList.remove(f.pveaVideoLoading),clearTimeout(p),p=m(function(){d.classList.remove(f.pveaTransitionNone)},350))};c();b("play",function(){n&&clearTimeout(n);n=m(function(){return d.classList.add(f.pveaVideoTransparent)},3E3)});b("canplay",t);b("canplaythrough",t);b("play",t);b("playing",t);b("waiting",function(){d.classList.contains(f.pveaVideoLoading)||(clearTimeout(p),d.classList.add(f.pveaVideoLoading),d.classList.add(f.pveaTransitionNone),
d.classList.remove(f.pveaVideoTouched))});b("messageDisplayed",function(){q();t()});b("messageCleared",c);b("handledMediaError",function(a){a.recoverable||q()});b("ended",q);h(d,function(){d.classList.add(f.pveaVideoTouched);clearTimeout(r);r=m(function(){return d.classList.remove(f.pveaVideoTouched)},3E3)});a&&(g(a,function(a){a&&a.stopPropagation();w(e);k("ctaClick",a)}),h(a,function(a){return a&&a.stopPropagation()}))},V=function(a,c){var e=!0,d=u.unscope(a.player);c.subscribe("playedByUser",function(){e=
!1;m["default"].elect(d);v(a.video)});c.subscribe("pausedByUser",function(){e=!1;m["default"].elect()});c.subscribe("ended",function(){return m["default"].unsubscribe(d)});m["default"].subscribe(d,function(b){b?(c.publish("videoVisible",{target:a.video}),e&&v(a.video)):w(a.video)})},W=function(a,c){var e=a.video,d=a.mutedIcon,b=a.unmutedIcon,g=c.subscribe;c=c.onClick;a=u.unscope(a.volumeControls);g("volumechange",function(){e.muted?(b.classList.add(f.pveaVideoHide),d.classList.remove(f.pveaVideoHide)):
(d.classList.add(f.pveaVideoHide),b.classList.remove(f.pveaVideoHide))});c(a,function(a){e.muted=!e.muted;return a&&a.stopPropagation()})},X=function(a,c,e){var d={endSlate:h["default"].cardRoot.getElementsByClassName(f.pveaVideoEndSlate)[0],loadIcon:h["default"].cardRoot.getElementsByClassName(f.pveaVideoLoad)[0],messageContainer:h["default"].cardRoot.getElementsByClassName(f.pveaVideoMessageContainer)[0],messageText:h["default"].cardRoot.getElementsByClassName(f.pveaVideoMessageText)[0],mutedIcon:h["default"].cardRoot.getElementsByClassName("pvea-video-muted")[0],
overlay:h["default"].cardRoot.getElementsByClassName(f.pveaVideoOverlay)[0],pauseIcon:h["default"].cardRoot.getElementsByClassName(f.pveaVideoPause)[0],playIcon:h["default"].cardRoot.getElementsByClassName(f.pveaVideoPlay)[0],player:a,redirectLink:h["default"].cardRoot.getElementsByClassName("pvea-video-overlay-link")[0],unmutedIcon:h["default"].cardRoot.getElementsByClassName("pvea-video-unmuted")[0],video:h["default"].cardRoot.getElementsByClassName(f.pveaVideoPlayer)[0],volumeControls:h["default"].cardRoot.getElementsByClassName(f.pveaVideoVolumeControls)[0]};
if(Object.keys(d).every(function(a){return!!d[a]})){var b=E(d);T(d,b);U(d,b);S(d,b);W(d,b);R(d,b);V(d,b);O(d.video,b,e);"function"===typeof c&&Q(b,c);K["default"].pageReady.then(function(){var a=d.video,b=a.dataset.posterHighRes;b&&L["default"].capabilities.hires&&0===a.currentTime&&(a.poster=b)});return{element:a,isPaused:function(){return d.video.paused},isPlaying:function(){return n(d.video)},pause:function(){return w(d.video)},play:function(){return v(d.video)}}}};x._operationNames=[];x.card=
function(){return y.__awaiter(void 0,void 0,void 0,function(){return y.__generator(this,function(a){try{var c=h["default"].cardRoot.getElementsByClassName(f.pveaVideoPlayer);if(c.length){var e=c[0];e.classList&&X(e,C,D)}else N(C);if(window.GWI&&window.GWI.util){var d=window.GWI.util,b=d.getParent("pvea-video"),g=d.gwiData(b);d.logScope(g.active)}p.count("PV.HUD-Video.initialize",1)}catch(l){D("An error was found on the player: "+l.message,"ERROR")}return[2]})})}});
