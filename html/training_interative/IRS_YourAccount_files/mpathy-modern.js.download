window.Mpathy=function(e){var t={};function n(o){if(t[o])return t[o].exports;var i=t[o]={i:o,l:!1,exports:{}};return e[o].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=e,n.c=t,n.d=function(e,t,o){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:o})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(n.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)n.d(o,i,function(t){return e[t]}.bind(null,i));return o},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="/code/5.5.5-mp/",n(n.s=0)}([function(e,t,n){"use strict";n.r(t),n.d(t,"getIntegrationData",(function(){return s.b})),n.d(t,"version",(function(){return u})),n.d(t,"Config",(function(){return l})),n.d(t,"State",(function(){return d})),n.d(t,"Tools",(function(){return f})),n.d(t,"FrameBridge",(function(){return p})),n.d(t,"Persister",(function(){return g})),n.d(t,"Project",(function(){return m})),n.d(t,"Engine",(function(){return h})),n.d(t,"Events",(function(){return b})),n.d(t,"start",(function(){return y})),n.d(t,"initConfig",(function(){return v})),n.d(t,"initState",(function(){return S})),n.d(t,"configureProject",(function(){return w})),n.d(t,"getVid",(function(){return k})),n.d(t,"setDebug",(function(){return O})),n.d(t,"applyConfigOverride",(function(){return C})),n.d(t,"resetConfigOveride",(function(){return E})),n.d(t,"setWebSDKVersion",(function(){return j})),n.d(t,"resetWebSDKVersion",(function(){return N})),n.d(t,"selectTrackingServer",(function(){return T})),n.d(t,"showConsole",(function(){return P})),n.d(t,"trackMe",(function(){return I}));var o=n(1);function i(){let e={},t={},n=[];this.set=(o,i)=>{this.hasOwnProperty(o)||Object.defineProperty(this,o,{configurable:!0,enumerable:!0,get:()=>e[o],set:i=>{let r=e[o];e[o]=i,(t[o]||[]).forEach(e=>{e(i,r)}),n.forEach(e=>{e(this)})}}),this[o]=i},this.merge=(e={})=>{Object.entries(e).forEach(([e,t])=>this.set(e,t))},this.watch=(o,i)=>{"function"!=typeof o&&"object"!=typeof o||(i=o,o=null),"function"==typeof i&&(i={handler:i}),null===o?n.push(i.handler):(t.hasOwnProperty(o)||(t[o]=[]),t[o].push(i.handler)),i.immediate&&i.handler(null===o?this:e[o]);let r=this;return()=>r.unwatch(o,i.handler)},this.unwatch=(e,n)=>{let o=t[e].indexOf(n);~o&&t[e].splice(o,1)}}var r=n(3),a=n(2);var c=n(6),s=n(9);const u="5.5.5-mp",l=window._mptc||{},d=function(e={}){let t=function(){};t.prototype=new i;let n=new t;return n.merge(e),n}(),f=n(1),p=n(6),g=n(2),m=n(3),h=n(4),b=new class{constructor(){this.eventHandlers=[],this.initialDispatchedEvents={},this.initialEventHandlers=[]}dispatch(e,t={},{target:n,delay:o=null}={}){if(null===o){if(this.initialDispatchedEvents.hasOwnProperty(e)||(this.initialDispatchedEvents[e]=t,this.checkInitialEventHandlers()),this.eventHandlers.forEach(n=>{if(n.event!==e)return!1;n.once&&this.off(e,n.callback);let o=n.callback(t);void 0!==o&&(t=o)}),n){let o=document.createEvent("CustomEvent");o.initCustomEvent("mpt_"+e,!1,!1,t),n.dispatchEvent(o)}return t}setTimeout(()=>this.dispatch(e,t,{target:n}),o)}on(e,t){return this.eventHandlers.push({event:e,callback:t}),()=>this.off(e,t)}once(e,t){return this.eventHandlers.push({event:e,callback:t,once:!0}),()=>this.off(e,t)}off(e,t){let n=this.eventHandlers.findIndex(n=>n.event===e&&n.callback===t);null!==n&&this.eventHandlers.splice(n,1)}onceInitial(e,t){"string"==typeof e&&(e=[e]),this.initialEventHandlers.push({events:e,callback:t}),this.checkInitialEventHandlers()}checkInitialEventHandlers(){let e=[];this.initialEventHandlers.forEach(({events:t,callback:n},o)=>{let i={};t.every(e=>!!this.initialDispatchedEvents.hasOwnProperty(e)&&(i[e]=this.initialDispatchedEvents[e],!0))&&e.push({index:o,callback:n,combinedPayload:i})}),e.reverse().forEach(({index:e})=>this.initialEventHandlers.splice(e,1)),e.forEach(({callback:e,combinedPayload:t})=>e(t))}};function y(){window.addEventListener("error",e=>{if(/\/\/[^/]+(foresee|answerscloud)\.com/.test(e.filename)){if(!(d.trackedErrors>=l.maxTrackedErrors))return d.trackedErrors++,Object(o.sendStatsRequest)({type:"error",msg:e.message,line:e.lineno+":"+e.colno,script_url:e.filename}),!1;Object(o.notify)("failed to relay JS Error, max allowed count of error requests reached.")}}),b.on("after_pi",()=>d.trackedErrors=0),Object(c.startFrameBridge)(),Object(a.startCookieRefreshInterval)(),v(),S(),document.readyState&&~["complete","loaded"].indexOf(document.readyState)?(d.domloadTime=+Date.now()-d.loadTime,b.dispatch("dom_loaded")):window.addEventListener("load",()=>{d.domloadTime=+Date.now()-d.loadTime,setTimeout(()=>b.dispatch("dom_loaded"),5)}),null===Object(a.getCookie)("module_version")?Object(o.notify)("starting WebSDK version "+u):Object(o.notify)(`starting WebSDK version ${u} (Testversion 🧪)`),d.watch("serverOffset",e=>{Object(a.setCookie)("server_offset",+e,"session"),T()}),d.consoleOpen&&window===parent&&Object(o.loadScript)(l.modulePath+"console-loader.js"),setTimeout(()=>{b.dispatch("mpathy_ready",null,{target:window}),l.autostartPrecheck&&(l.waitForDOMLoad?b.onceInitial("dom_loaded",()=>Object(r.startProject)()):Object(r.startProject)())},5)}function v(){Object(o.mergeDefaults)(l,{trackingServerHost:null,asyncPrecheck:!1,trackingCookieLifetime:"30d",maxTrackedErrors:10,idsite:null,uploadTime:null,devices:[],domain:".*",trackingRate:0,trackingServers:[],useSamplingRates:!0,setup:{},cookieDomain:null,stopOnTranslation:!0,autostartPrecheck:!0,autostartTracking:!0,recordKeyEvents:!0,maskFullPage:!0,maskAllInputs:!0,piCheckActiveElement:!0,propertyYesValue:"yes",propertyNoValue:"no",bufferRecording:"rolling",bufferRecordingLimit:6,bufferRecordingCompression:!0,bufferCompressionFirstPi:!1,compressionSizeMin:5e4,compressionSizeMax:7e5,enableTEOLogging:!0,opinionlabIntegration:!0,foreseeIntegration:!0,waitForDOMLoad:!0,maskUrl:""});let e=l.setup.config||{};void 0===e.maskAllInputs&&(e.maskAllInputs=!1),Object.assign(l,e),null!=Object(a.getCookie)("config_override")&&Object.assign(l,JSON.parse(Object(a.getCookie)("config_override")))}function S(){let e=Object(a.getCookie)("recording_to_buffer_"+l.idsite);d.merge({debug:!!+Object(a.getCookie)("debug",0),consoleOpen:!!+Object(a.getCookie)("console",0),loadTime:+Date.now(),trackedErrors:0,serverOffset:+Object(a.getCookie)("server_offset",0),recordingToBuffer:null===e?e:!!+e,conditionalImport:!!+Object(a.getCookie)("conditional_import_"+l.idsite,0),pagenames:[],rates:[],scopes:[],rateComparator:0,precheckStatus:"pending",rejectMessage:null,pagename:null,propertiesHash:null,isUnmappedPagename:!1,trackingStatus:"initial",socketStatus:"initial",nativeCompressionSupported:!1,previousPID:null,currentPID:null,domloadTime:null,piStartTime:0,initialReferer:Object(a.rememberCookie)("initial_referer","session",()=>document.referrer||null),matchingScopesConfig:null})}function w(e){l.customcode=e}function k(){return Object(a.rememberCookie)("vid","730d",()=>String(Date.now())+String(Math.floor(9e4*Math.random())+1e4))}function O(e=!0){return Object(a.setCookie)("debug",+e,"session"),console.log("[m-pathy] 🦄 %cStarting debug mode after reload...","color: green"),setTimeout(()=>location.reload(),500),window.Mpathy}function C(e){if("object"==typeof e&&0!==Object.keys(e).length)return Object(a.setCookie)("config_override",JSON.stringify(e),"session"),setTimeout(()=>location.reload(),500),window.Mpathy;Object(o.notify)("error","Invalid first argument: Expected Object")}function E(){return Object(a.removeCookie)("config_override"),setTimeout(()=>location.reload(),500),window.Mpathy}function j(e=null,t=null){return null!==e&&Object(a.setCookie)("module_version",e,"session"),null!==t&&Object(a.setCookie)("module_host",t,"session"),console.log("[m-pathy] 🧪 %cLoading test version after reload...","color: green"),setTimeout(()=>location.reload(),500),window.Mpathy}function N(){return Object(a.removeCookie)("module_version"),Object(a.removeCookie)("module_host"),console.log("[m-pathy] 🧪 %reset test version after reload...","color: green"),setTimeout(()=>location.reload(),500),window.Mpathy}function T(){if(!l.idsite)return;let e=l.trackingServers,t=(k().slice(-5)+d.serverOffset)%e.length;l.trackingServerHost=e[t]}function P(e=!0){return Object(a.setCookie)("console",+e,"session"),console.log("[m-pathy] ⏳ %cStarting m-pathy console after reload...","color: blue"),setTimeout(()=>location.reload(),500),window.Mpathy}function I(e=!0){return m.setTrackingActiveCookie(e),e&&Object(a.removeCookie)("tracking_stopped_"+l.idsite),console.log("[m-pathy] ⏳ %cStarting tracking after reload...","color: blue"),setTimeout(()=>location.reload(),500),window.Mpathy}},function(e,t,n){"use strict";n.r(t),n.d(t,"notify",(function(){return r})),n.d(t,"loadScript",(function(){return a})),n.d(t,"resolvePath",(function(){return c})),n.d(t,"mergeDefaults",(function(){return s})),n.d(t,"sendRequest",(function(){return u})),n.d(t,"sendStatsRequest",(function(){return l})),n.d(t,"generateQueryString",(function(){return d})),n.d(t,"getVersionsString",(function(){return f})),n.d(t,"getDeviceType",(function(){return p})),n.d(t,"isMobile",(function(){return g})),n.d(t,"arrayUniq",(function(){return m})),n.d(t,"resolveNodes",(function(){return h})),n.d(t,"isVisible",(function(){return b})),n.d(t,"throttle",(function(){return y})),n.d(t,"debounce",(function(){return v})),n.d(t,"getScrollingElement",(function(){return S})),n.d(t,"scrambleString",(function(){return w})),n.d(t,"anonymizeString",(function(){return k})),n.d(t,"getScrollTop",(function(){return C})),n.d(t,"getScrollLeft",(function(){return E})),n.d(t,"getOrientation",(function(){return j})),n.d(t,"isScrollingDisabled",(function(){return N})),n.d(t,"getClientWidth",(function(){return T})),n.d(t,"getClientHeight",(function(){return P})),n.d(t,"isTouchDevice",(function(){return I})),n.d(t,"matchSelector",(function(){return x})),n.d(t,"loopNodeTree",(function(){return M})),n.d(t,"findParent",(function(){return D})),n.d(t,"getMatchingParent",(function(){return _})),n.d(t,"getNodeDimensions",(function(){return A})),n.d(t,"getElementXPath",(function(){return R})),n.d(t,"matchString",(function(){return L})),n.d(t,"onNodeInserted",(function(){return H})),n.d(t,"getBlobSize",(function(){return X}));var o=n(0);const i={a:8.12,b:9.61,c:12.32,d:16.64,e:28.66,f:30.96,g:32.99,h:38.91,i:46.23,j:46.33,k:47.02,l:51,m:53.61,n:60.56,o:68.24,p:70.06,q:70.17,r:76.19,s:82.47,t:91.57,u:94.45,v:95.56,w:97.65,x:97.82,y:99.93,z:100};function r(...e){if(!o.State.debug)return;let t="log";e.length>1&&["error","warn","info","log","debug","table"].includes(e[0])&&(t=e[0],e.splice(0,1)),"string"==typeof e[0]&&(e[0]="[m-pathy] "+e[0],parent!=window&&(e[0]="[iframe] "+e[0])),"object"==typeof window.console&&"function"==typeof window.console[t]&&window.console[t](...e)}function a(e,t){let n=document.createElement("script");n.setAttribute("src",c(e)),n.setAttribute("async",!0),n.setAttribute("type","text/javascript"),n.setAttribute("charset","utf-8"),n.setAttribute("crossorigin","anonymous"),t instanceof Function&&n.addEventListener("load",t),document.head.appendChild(n)}function c(e){return e.replace(/%CDN_HOST%/g,o.Config.cdnHost).replace(/%TRACKING_SERVER_HOST%/g,o.Config.trackingServerHost).replace(/%VERSION%/g,o.Config.requiredSDKVersion).replace(/%IDSITE%/g,o.Config.idsite).replace(/%CONTAINER%/,o.Config.container).replace(/%SITE_KEY%/,o.Config.siteKey)}function s(e,t){return Object.keys(t).forEach(n=>{e.hasOwnProperty(n)||(e[n]=t[n])}),e}function u(e,t={}){if(null===o.Config.trackingServerHost)return void r("warn","Request could not be send. No trackingServerHost has been set yet.");let n=new XMLHttpRequest,i=o.State.serverOffset;t={method:"POST",query:{},data:{},retry:0,maxRetries:5,onSuccess:null,onError:null,isJson:!1,...t},n.onreadystatechange=()=>{4===n.readyState&&200===n.status&&(t.retry=0,"function"==typeof t.onSuccess&&t.onSuccess(n.responseText,n.status))},n.onerror=()=>{t.retry>=t.maxRetries?"function"==typeof t.onError&&t.onError(n.status):(i===o.State.serverOffset&&o.State.serverOffset++,setTimeout(()=>{t.retry++,u(e,t)},1e3))},t.isJson&&(n.setRequestHeader("Content-Type","application/json; charset=utf-8"),t.data=JSON.stringify(t.data)),e=c(e),Object.keys(t.query).length>0&&(e+=d(t.query));try{n.open(t.method.toUpperCase(),e,!0),n.send(t.data)}catch(e){r("warn","Failed to send PostRequest")}}function l(e={}){u("//%TRACKING_SERVER_HOST%/ps",{method:"GET",query:{idsite:o.Config.idsite,pid:o.State.currentPID||42,vid:Object(o.getVid)(),pn:o.State.pagename,url:location.href,user_agent:window.navigator.userAgent,versions:f(),...e}})}function d(e){return"?"+Object.entries(e).map(([e,t])=>e+"="+encodeURIComponent(t)).join("&")}function f(){let e="SDK: "+o.Config.requiredSDKVersion;return o.Config.uploadTime&&(e+=" | UP: "+o.Config.uploadTime),e}function p(){return/((i|view|touch)pad|lenovo|tablet(?! pc)|bolt|xoom|playbook|kindle|gt-p|sch-i|sch-t|mz609|mz617|mid7015|tf101|g-v|ct1002|transformer|silk|tab|nexus (7|\d{2}))\b/i.test(navigator.userAgent)||/android/i.test(navigator.userAgent)&&!/mobile/i.test(navigator.userAgent)?"tablet":/(up.browser|up.link|mmp|symbian|smartphone|midp|wap|webos|galaxy|phone|pocket|psp|treo|android|mobile|240x320|400X240|nitro|nokia|portalmmm|proxinet|blackberry|palm|series40|series60|s60|sonyericsson|e10i|samsung|nexus|htc|desire|ipod|itunes|vodafone|wap-|wapi|wapa|wapp)/i.test(navigator.userAgent)?"phone":"desktop"}function g(){return"desktop"!==p()}function m(e){return e.filter((t,n)=>e.indexOf(t)===n)}function h(e,t){let n,o=document;return e instanceof Function&&(e=e()),e instanceof NodeList?n=e:e instanceof Node||e instanceof Document||e instanceof Window?n=[e]:(Array.isArray(e)&&(o=e[0],e=e[1],o instanceof Function&&(o=o())),n=o.querySelectorAll(e)),t?n[0]:Array.from(n)}function b(e){return h(e).some(e=>!!e&&(!(!e.offsetWidth&&!e.offsetHeight)||"function"==typeof e.getClientRects&&e.getClientRects().length>0))}function y(e,t){let n=!1;return(...o)=>{n||(e(...o),n=!0,setTimeout(()=>n=!1,t))}}function v(e,t){let n;return(...o)=>{clearTimeout(n),n=setTimeout(()=>{e(...o)},t)}}function S(){return document.scrollingElement||document.body.parentNode||document.body||document.documentElement}function w(e){let t=e.split("");e="";for(let n=0;n<t.length;n++){let o=t[n];if(/\d/.test(o)&&(o="0"),/[a-zA-Z\u00C0-\u1FFF\u2800-\uFFFD]/.test(o)){let e=100*Math.random();for(let t in i)if(e<=i[t]){o=o.toUpperCase()===o?t.toUpperCase():t;break}}e+=o}return e}function k(e,t=null){if(t instanceof RegExp){return 1===Array.from(e.match(t)||[]).length?k(e):String(e).replace(t,(e,...t)=>(t.splice(-2),t.forEach(t=>e=e.replace(t,k(t))),e))}return String(e).replace(/([\s\S]*?)(&#?\w+;|$)/g,(e,t,n)=>(t=t.split("").map(O).join(""))+n)}function O(e){return/\s/.test(e)?e:/\u00E4|\u00F6|\u00FC|\u00DF/.test(e)?"u":/\u00C4|\u00D6|\u00DC/.test(e)?"U":/[a-z]|[\u0080-\uFFFF]/.test(e)?"x":/[A-Z]/.test(e)?"X":/\d/.test(e)?"0":e}function C(){let e=S().scrollHeight-window.innerHeight;return Math.max(0,Math.min(S().scrollTop,e))}function E(){let e=S().scrollWidth-window.innerWidth;return Math.max(0,Math.min(S().scrollLeft,e))}function j(){return screen.orientation?screen.orientation.angle:window.orientation||0}function N(){let e=!1;try{e=window.frameElement&&window.frameElement.scrolling&&"no"===window.frameElement.scrolling}catch(e){}return e}function T(){return("BackCompat"===document.compatMode?document.body:document.documentElement).clientWidth}function P(){return("BackCompat"===document.compatMode?document.body:document.documentElement).clientHeight}function I(){return"ontouchstart"in document}function x(e,t,n=!1){let o=document.documentElement.matches||document.documentElement.msMatchesSelector||document.documentElement.webkitMatchesSelector;return n?!!+t.split(/, */).some(t=>o(e,t)||o(e,t+" *")):o.call(e,t)}function M(e,t){for(;e;){if(!1===t(e))return;e=e.parentNode}}function D(e,t){for(;e.parentNode;){if(t(e.parentNode))return e.parentNode;e=e.parentNode}return null}function _(e,t){return D(e,e=>x(e,t))}function A(e){e.correspondingUseElement&&(e=e.correspondingUseElement);let t={};if(e.getBoundingClientRect){let n=e.getBoundingClientRect();t.width=n.width,t.height=n.height,t.top=n.top,t.left=n.left}return t.width||(t.width=e.offsetWidth),t.height||(t.height=e.offsetHeight),t.top||(t.top=e.offsetTop),t.left||(t.left=e.offsetLeft),t}function R(e){if(e===document.body||e===document.documentElement)return"//"+e.tagName;let t=e.hasOwnProperty("mptOldParentNode")?e.mptOldParentNode:e.parentNode;if(!t)return"//"+e.tagName+Array.from(e.attributes||[]).map(e=>`[@${e.name}="${e.value}"]`);let n=R(t),o="http://www.w3.org/2000/svg"===e.namespaceURI?'*[name()="'+e.tagName+'"]':e.tagName;if(t.childNodes.length>0){let t=1,i=e.previousElementSibling;for(;i;)i.tagName===e.tagName&&t++,i=i.previousElementSibling;return`${n}/${o}[${t}]`}return 0===t.childNodes.length&&t.correspondingUseElement?(t=t.correspondingUseElement,R(t)):e.hasOwnProperty("mptClickableChild")?`${n}/${o}[${e.mptClickableChild.index}]`:`${n}/${o}`}function L(e,t){if(e instanceof Function){let n=e(t);if("boolean"==typeof n)return n;e=n}return"string"==typeof e?e===t:e instanceof RegExp?e.test(t):!!Array.isArray(e)&&e.some(e=>L(e,t))}function H(e,t,n,o=!1){let i=h(e);if(!i.length)return void r("debug",`onDOMNodeInserted: ${e} not found`);let a=new MutationObserver(e=>{e.forEach(({addedNodes:e})=>{Array.from(e||[]).forEach(e=>{e.nodeType==Node.ELEMENT_NODE&&x(e,t)&&n()})})});return i.forEach(e=>{a.observe(e,{childList:!0,subtree:o})}),()=>a.disconnect()}function X(e){let t=e;return"string"==typeof e?t=[e]:navigator.userAgent.includes("Trident/")&&(t=[JSON.stringify(e)]),new Blob(t,{type:"text/plain"}).size}},function(e,t,n){"use strict";n.r(t),n.d(t,"startCookieRefreshInterval",(function(){return i})),n.d(t,"getCookie",(function(){return r})),n.d(t,"setCookie",(function(){return a})),n.d(t,"removeCookie",(function(){return c})),n.d(t,"rememberCookie",(function(){return s})),n.d(t,"resetCookies",(function(){return u})),n.d(t,"refreshCookies",(function(){return d})),n.d(t,"calculateExpiry",(function(){return f}));var o=n(0);function i(){setInterval(d,6e4),d()}function r(e,t=null,{prefix:n=null}={}){let o=l(p(n,e));return o&&(String(o.expiry).includes("session")||o.expiry>=+Date.now())?o.value:t}function a(e,t,n="30d",{prefix:i=null}={}){let r=p(i,e),a=function(){if(o.Config.cookieDomain)return o.Config.cookieDomain;let e=location.hostname.match(/(?:[^.]+\.)?\w+$/);o.Config.cookieDomain=e?e[0]:location.hostname;return o.Config.cookieDomain}();t=encodeURIComponent(t);let c=n=f(n);+c?c=Math.min(c,f("7d")):"session_timeout"===c&&(c=Date.now()+18e5);let s=`${r}=${t}|${n}`;+c&&(s+=";expires="+new Date(c).toGMTString()),s+=";path=/;domain="+a,function(){let e=navigator.userAgent;if(e.includes("CPU iPhone OS 12")||e.includes("iPad; CPU OS 12"))return!1;if(e.includes("Safari")&&e.includes("Macintosh; Intel Mac OS X 10_14")&&e.includes("Version/"))return!1;if(e.includes("Chrome/5")||e.includes("Chrome/6"))return!1;return!0}()&&(s+=";samesite=none"),s+=";secure",document.cookie=s}function c(e,{prefix:t=null}={}){a(e,0,Date.now(),{prefix:t})}function s(e,t,n,{prefix:o=null}={}){let i=r(e,null,{prefix:o});return null===i&&(i=n(),null!==i&&a(e,i,t,{prefix:o})),i}function u(e=null){null===e&&(e=new RegExp("mpt_")),g(e,c)}function l(e){let t=new RegExp(`(?:^|;\\s?)${e}=(.*?)(?:\\|(\\d+|session|session_timeout))?(?:;|$)`),n=document.cookie.match(t);if(!n)return null;let o=n[2]||"session";return isNaN(o)||(o=+o),{value:decodeURIComponent(n[1]),expiry:o}}function d(){let e=+Date.now();g(new RegExp("mpt_"),t=>{let n=l(t);if(!n)return;let{expiry:o,value:i}=n;(+o&&o>=e||"session_timeout"===o)&&a(t,i,o)})}function f(e){if("string"==typeof e){if("session"===e||"session_timeout"===e)return e;let t=e.match(/(\d+)([mhd])/);if(t){if("m"===t[2])return Date.now()+6e4*t[1];if("h"===t[2])return Date.now()+36e5*t[1];if("d"===t[2])return Date.now()+864e5*t[1]}}return isNaN(e)?"session":+e}function p(e,t){return null===e&&(e="mpt_"),!1===e||t.startsWith(e)||(t=e+t),encodeURIComponent(t)}function g(e,t){(document.cookie.match(/(?:^|;\s?)([^=]+)/g)||[]).forEach(n=>{let o=decodeURIComponent(n).replace(/^;\s?/,"");e.test(o)&&t(o)})}},function(e,t,n){"use strict";n.r(t),n.d(t,"Matcher",(function(){return m})),n.d(t,"Property",(function(){return h})),n.d(t,"startProject",(function(){return b})),n.d(t,"addPagename",(function(){return y})),n.d(t,"addRate",(function(){return v})),n.d(t,"resolvePrecheck",(function(){return S})),n.d(t,"resolvePrecheckAsync",(function(){return w})),n.d(t,"rejectPrecheck",(function(){return k})),n.d(t,"getPagename",(function(){return O})),n.d(t,"addScope",(function(){return C})),n.d(t,"delayCheckPI",(function(){return E})),n.d(t,"setTrackingActiveCookie",(function(){return j}));var o=n(1),i=n(0),r=n(4),a=n(5);class c{constructor(e){this.config={matcherCallback:e,pagenameModifier:[],properties:[],listeners:[],nodeConfig:[]},this._cachedMatching=!1,this._boundListeners=[],i.Events.on("after_pi",()=>{this.unbindListeners(this.isMatching),this.isMatching()&&this.bindListeners()})}isMatching(e){return e&&(this._cachedMatching=Object(a.applyMatcher)(this.config.matcherCallback)),this._cachedMatching}addNodeConfig(e,t={}){this.config.nodeConfig.push({selector:e,config:t})}addPagenameModifier(e,t,n=!1){this.config.pagenameModifier.push({pagename:e,matcherCallback:t,override:n})}applyPagenameModifier(e){return this.config.pagenameModifier.forEach(t=>{t.pagename instanceof Function?e=t.pagename(e)||null:Object(a.applyMatcher)(t.matcherCallback)&&(e=t.override?t.pagename:e+t.pagename)}),e}addProperty(e,t,n={}){this.config.properties.push({name:e,valueCallback:t,...n})}on(e,t,n){Object(o.notify)("warn","Scope.on() is deprecated an will be removed in the future"),this.config.listeners.push({selector:e,event:t,callback:n})}bindListeners(){this.config.listeners.forEach(({selector:e,event:t,callback:n})=>{Object(o.resolveNodes)(e).forEach(e=>{let{bind:o,unbind:i}=t(e,n);this._boundListeners.push(i),o()})})}unbindListeners(){this._boundListeners.forEach(e=>{this._cachedMatching||e()}),this._boundListeners=[]}}var s=n(7),u=n(2),l=n(8),d=n(9);let f,p,g=Object(o.getDeviceType)();const m=n(5),h=n(8);function b(){Object(o.notify)("info",`started evaluating site #${i.Config.idsite} (Upload Time ${i.Config.uploadTime||"none"})`),null!==i.Config.idsite?(i.State.rateComparator=+Object(u.rememberCookie)("rate_comparator_"+i.Config.idsite,i.Config.trackingCookieLifetime,()=>{let e=100*Math.random();return Object(o.notify)("🎲 rate comparator has been diced to: "+e),e}),Object(i.selectTrackingServer)(),function(){if(!new RegExp(i.Config.domain,"i").test(location.hostname))return k("Domain Mismatch");if(i.Config.devices&&!~i.Config.devices.indexOf(g))return k("Device Type Mismatch");"function"==typeof i.Config.customcode&&i.Config.customcode(window.Mpathy,window.Mpathy.Project);if(function(){let e=i.Config.setup;Array.isArray(e.pagenames)&&e.pagenames.forEach(N);"global"===i.Config.trackingMode&&y(()=>(i.State.isUnmappedPagename=!0,"documentTitle"===i.Config.autoPagename?document.title:location.pathname));Array.isArray(e.properties)&&e.properties.forEach(T);Array.isArray(e.rates)&&e.rates.forEach(P);if(i.Config.defaultRates){let{desktop:e,tablet:t,phone:n}=i.Config.defaultRates;v(/.*/,{desktop:e,tablet:t,phone:n})}Array.isArray(e.unmasking)&&e.unmasking.forEach(e=>I("unmasking",e));Array.isArray(e.anonymization)&&e.anonymization.forEach(e=>I("masking",e))}(),+Object(u.getCookie)("tracking_stopped_"+i.Config.idsite))return k("Tracking Stopped");"pending"!==i.State.precheckStatus||i.Config.asyncPrecheck||S()}()):Object(o.notify)("warn","Could not start project: Missing site configuration")}function y(e,t){t="function"==typeof t?t:m.url(t),i.State.pagenames.push({pagename:e,matcherCallback:t})}function v(e,t){e="function"==typeof e?e:m.pagename(e),i.State.rates.push({matcherCallback:e,rate:t})}function S(){if(clearInterval(f),clearTimeout(p),"pending"!==i.State.precheckStatus)return void Object(o.notify)("warn","Precheck has already resolved.");return null===O()?k("Pagename Mismatch"):function(){if(Array.isArray(i.Config.setup.blacklist))return i.Config.setup.blacklist.some(s.a);return!1}()?k("Page Blacklisted"):(Object(o.notify)("%c✔️ Precheck resolved successfully!","color: green"),i.State.precheckStatus="resolved",function(){let e=i.State.rates.find(({matcherCallback:e})=>Object(a.applyMatcher)(e));if(!e)return;i.Config.trackingRate="object"==typeof e.rate?+e.rate[g]:+e.rate}(),i.Events.dispatch("project_resolved"),+Object(u.getCookie)("tracking_active_"+i.Config.idsite)?Object(r.initEngine)():i.Config.useSamplingRates&&(!function(){let e=i.State.rateComparator<=i.Config.trackingRate;return j(e),e}()?Object(o.notify)("log","⚠️ %cRecording not started automatically: Rate Mismatch.","color: orange"):Object(r.initEngine)()),Object(d.a)(),!0)}function w({callback:e,interval:t=500,timeout:n=1e4}){e(),"pending"===i.State.precheckStatus&&(f=setInterval(e,t),p=setTimeout(()=>{clearInterval(f),k("asyncResolve Timeout")},n))}function k(e){return clearInterval(f),clearTimeout(p),i.State.precheckStatus="rejected",i.State.rejectMessage=e,i.Events.dispatch("project_resolved"),Object(o.notify)("🛑 %cTracking rejected:","color: red; font-weight: bold",e),!1}function O(){let e=null;return i.State.isUnmappedPagename=!1,i.State.pagenames.some(({pagename:t,matcherCallback:n})=>{if(t instanceof Function?e=t()||null:Object(a.applyMatcher)(n)&&(e=t||null),null!==e)return i.State.pagename=e,!0}),null!==e&&"resolved"===i.State.precheckStatus&&i.State.scopes.forEach(t=>{t.isMatching(!0)&&(e=t.applyPagenameModifier(e),i.State.pagename=e)}),e}function C(e,t){"function"!=typeof e&&(e=m.pagename(e));let n=new c(e);i.State.scopes.push(n),t instanceof Function&&t(n)}function E(e){return()=>Object(r.checkPI)({delay:e})}function j(e,t=null){Object(u.setCookie)("tracking_active_"+i.Config.idsite,+e,t||i.Config.trackingCookieLifetime)}function N(e){let{name:t=null,matchAll:n=!1,conditions:o=[],anonymizePage:r=!1,unmaskPage:a=!1}=e,c=i.Config.maskFullPage?a:r;y(t,m.conditions(n,o)),c&&C(m.conditions(n,o),e=>{e.addNodeConfig("body",{maskText:!i.Config.maskFullPage})})}function T(e){let{name:t="",type:n="",matchAll:o=!1,config:i={},conditions:r=[],selector:a="",overwrite:c=!1,decimalSeparator:s,defaultValue:u=null,values:d=[]}=e;i={sessionProperty:!1,...i},C(m.conditions(o,r),e=>{let o,r={overwrite:c,session:i.sessionProperty};switch(n){case"count":o=Object(l.count)(a),r.type="int";break;case"extract_text":o=Object(l.extractText)(a,u);break;case"extract_number":o=Object(l.extractNumber)(a,u,s),r.type="float";break;case"multiple":o=Object(l.multiple)(d,u)}e.addProperty(t,o,r)})}function P(e){let{desktop:t=0,tablet:n=0,phone:o=0,matchAll:i=!1,conditions:r=[]}=e;v(m.conditions(i,r),{desktop:t,tablet:n,phone:o})}function I(e,t){let{conditions:n=[],matchAll:o=!1,scope:i="global",selector:r=null}=t;r="selector"===i?r:"body",C(m.conditions(o,n),t=>{let n="masking"===e;t.addNodeConfig(r,{maskText:n})})}},function(e,t,n){"use strict";n.r(t),n.d(t,"initEngine",(function(){return jt})),n.d(t,"startTracking",(function(){return Nt})),n.d(t,"startConditionalRecording",(function(){return Tt})),n.d(t,"pauseTracking",(function(){return Pt})),n.d(t,"stopTracking",(function(){return It})),n.d(t,"activateSession",(function(){return xt})),n.d(t,"getRelTime",(function(){return Mt})),n.d(t,"maskUrl",(function(){return Dt})),n.d(t,"checkPI",(function(){return _t})),n.d(t,"setProperty",(function(){return At}));var o=n(0),i=n(3),r=n(10),a=n(1),c=String.fromCharCode;function s(e){return null==e?"":function(e,t,n){if(null==e)return"";var o,i,r,a={},c={},s="",u="",l="",d=2,f=3,p=2,g=[],m=0,h=0;for(r=0;r<e.length;r+=1)if(s=e.charAt(r),Object.prototype.hasOwnProperty.call(a,s)||(a[s]=f++,c[s]=!0),u=l+s,Object.prototype.hasOwnProperty.call(a,u))l=u;else{if(Object.prototype.hasOwnProperty.call(c,l)){if(l.charCodeAt(0)<256){for(o=0;o<p;o++)m<<=1,h==t-1?(h=0,g.push(n(m)),m=0):h++;for(i=l.charCodeAt(0),o=0;o<8;o++)m=m<<1|1&i,h==t-1?(h=0,g.push(n(m)),m=0):h++,i>>=1}else{for(i=1,o=0;o<p;o++)m=m<<1|i,h==t-1?(h=0,g.push(n(m)),m=0):h++,i=0;for(i=l.charCodeAt(0),o=0;o<16;o++)m=m<<1|1&i,h==t-1?(h=0,g.push(n(m)),m=0):h++,i>>=1}0==--d&&(d=Math.pow(2,p),p++),delete c[l]}else for(i=a[l],o=0;o<p;o++)m=m<<1|1&i,h==t-1?(h=0,g.push(n(m)),m=0):h++,i>>=1;0==--d&&(d=Math.pow(2,p),p++),a[u]=f++,l=String(s)}if(""!==l){if(Object.prototype.hasOwnProperty.call(c,l)){if(l.charCodeAt(0)<256){for(o=0;o<p;o++)m<<=1,h==t-1?(h=0,g.push(n(m)),m=0):h++;for(i=l.charCodeAt(0),o=0;o<8;o++)m=m<<1|1&i,h==t-1?(h=0,g.push(n(m)),m=0):h++,i>>=1}else{for(i=1,o=0;o<p;o++)m=m<<1|i,h==t-1?(h=0,g.push(n(m)),m=0):h++,i=0;for(i=l.charCodeAt(0),o=0;o<16;o++)m=m<<1|1&i,h==t-1?(h=0,g.push(n(m)),m=0):h++,i>>=1}0==--d&&(d=Math.pow(2,p),p++),delete c[l]}else for(i=a[l],o=0;o<p;o++)m=m<<1|1&i,h==t-1?(h=0,g.push(n(m)),m=0):h++,i>>=1;0==--d&&(d=Math.pow(2,p),p++)}for(i=2,o=0;o<p;o++)m=m<<1|1&i,h==t-1?(h=0,g.push(n(m)),m=0):h++,i>>=1;for(;;){if(m<<=1,h==t-1){g.push(n(m));break}h++}return g.join("")}(e,15,(function(e){return c(e+32)}))+" "}var u=n(2);let l={idsite:0,pagename:"",snapshotSize:0,snapshotTime:0,mutationCount:0,maxMutationSize:0,maxMutationTime:0,totalMutationSize:0,totalMutationTime:0,piDuration:0,bufferedSize:0,bufferedPis:0,bufferedDiscardedPis:0,bufferedEvents:0,bufferRecordingType:"none"},d=["snapshotSize","snapshotTime","bufferedSize","bufferedPIs","bufferedEvents","bufferRecordingType"],f={},p={...l},g=!1;function m(e){g&&(f[e]={startTime:performance.now()})}function h({mutationId:e,mutationData:t}){if(!g)return;let n=performance.now(),{startTime:i}=f[e],r=Math.round(n-i),c=Number(new Blob([t],{type:"application/json"}).size)||0;isNaN(r)||isNaN(c)||("snapshot"===e?function({mutationSize:e,mutationTime:t}){(t>150||e>1e6)&&Object(a.notify)("warn",`Processing DOM Snapshot took ${t}ms for a size of ${Math.round(e/1e3)}kb`);p.snapshotSize=e,p.snapshotTime=t}({mutationSize:c,mutationTime:r}):function({mutationSize:e,mutationTime:t}){(t>50||e>1e5)&&Object(a.notify)("warn",`Processing mutation took ${t}ms for a size of ${Math.round(e/1e3)}kb`);p.maxMutationSize=Math.max(p.maxMutationSize,e),p.maxMutationTime=Math.max(p.maxMutationTime,t),p.totalMutationSize+=e,p.totalMutationTime+=t,p.piDuration=Mt()||0,p.mutationCount+=1}({mutationSize:c,mutationTime:r}),p.pagename=o.State.pagename,p.idsite=o.Config.idsite,delete f[e])}function b(e){p={...p,...e}}function y(e={}){e.msg=JSON.stringify(e.msg||p),Object(a.sendStatsRequest)({type:"teo",...e})}function v(){let e={idsite:o.Config.idsite,pid:o.State.currentPID||42,vid:Object(o.getVid)(),pn:o.State.pagename,url:location.href,user_agent:window.navigator.userAgent,versions:Object(a.getVersionsString)(),msg:p};localStorage.setItem("mpt_teo_stats",JSON.stringify(e))}let S,w=!1,k="",O=null,C=null,E=[],j=[],N=0,T=0,P=0,I=!1;function x(){if(w)return;w=!0,k="pages_"+o.Config.idsite,b({bufferRecordingType:o.Config.bufferRecording});let e=setInterval(()=>{N=0},1e4),t=window.indexedDB.open("mpathy-local-buffer",1);t.addEventListener("upgradeneeded",({target:e})=>{S=e.result,S.createObjectStore(k,{keyPath:"idpage"})}),t.addEventListener("success",({target:t})=>{if(S=t.result,!S.objectStoreNames.contains(k))return Object(a.notify)(`📝 Site ID (${o.Config.idsite}) has changed on same domain --\x3e resetting local buffer`),clearInterval(e),w=!1,S.close(),void A(()=>{z(),x()});S.addEventListener("close",()=>{Object(a.notify)("warn","local buffer connection closed"),W()}),function(e){let t=F(k).openCursor();t.addEventListener("success",t=>{let n=t.target.result;n?(T+=n.value.events.length,P+=n.value.piCount,E.push(n.value),n.continue()):e()}),t.addEventListener("error",()=>Object(a.notify)("error","Error trying to get initial indexeddb pages"))}(()=>{let e=!1,t=R();if(E.length){let{lastActivity:t}=E[E.length-1];e=Date.now()-t>18e5}I=0===E.length||0===t||e,0===t||e?V(U):U()})}),t.addEventListener("error",()=>{Object(a.notify)("error","error connecting local buffer database"),D()})}function M(e){O=e}function D(){for(o.State.recordingToBuffer=!1,Object(u.setCookie)("recording_to_buffer_"+o.Config.idsite,0,"2h"),Y(),W(),re();E.length>0;){let{events:e}=E.shift();for(let t=0;t<e.length;t++)ce(e[t])}V()}function _(e=!0){W(),Pt(),M(null),j=[],N+=1,Nt(),e?V(U):U()}function A(e){let t=window.indexedDB.deleteDatabase("mpathy-local-buffer");return"function"==typeof e&&t.addEventListener("success",e),t}function R(){return+localStorage.getItem("mpt_buffer_size")}function L(e){localStorage.setItem("mpt_buffer_size",e)}function H(){return+localStorage.getItem("mpt_discarded_pis")}function X(e){localStorage.setItem("mpt_discarded_pis",e)}function F(e){return S.transaction(e,"readwrite").objectStore(e)}function V(e){let t=F(k).clear();z(),"function"==typeof e&&t.addEventListener("success",e),t.addEventListener("error",()=>{Object(a.notify)("error","error clearing stored pages"),"function"==typeof e&&e()})}function z(){E=[],L(0),X(0),T=0,P=0}function U(){C=setInterval(Y,1e3)}function W(){clearInterval(C)}function Y(){let e=[],t=0,n=0;for(;j.length>0;){let i=j.shift();13===i[0]&&(n+=1),!o.Config.bufferRecordingCompression||I&&!o.Config.bufferCompressionFirstPi||se(i),I&&15===i[0]&&(I=!1),t+=Object(a.getBlobSize)(i),e.push(i)}T+=e.length;let i=1024*o.Config.bufferRecordingLimit*1024,r=R(),c=r+t;c<i?(L(c),$(q(e,n))):"rolling"===o.Config.bufferRecording?(Object(a.notify)("warn","local buffer reached its limit --\x3e deleting older pages"),W(),t>i?(V(),j=[],Object(a.notify)("Deleting all buffer data and stop buffering for this page as total size of new events exceeds total buffer")):N>=3?(V(),j=[],Object(a.notify)("Deleting all buffer data and stop buffering for this page as too many snapshots were generated (>3 in 10000ms")):function(e,t,n,i){let r=1024*o.Config.bufferRecordingLimit*1024,c=e,s=F(k).openCursor();s.addEventListener("success",e=>{let o=e.target.result;if(!o)return;let{events:s,idpage:u,piCount:l}=o.value,{idpage:d}=E[0],f=Object(a.getBlobSize)(s);if(d===u&&d===O)return Object(a.notify)("Only one entry and buffer is full --\x3e clearing whole buffer and restarting with new Snapshot"),_();o.delete(),Object(a.notify)(`🚮 Entry PID: ${u}, Size: ${Math.round(f/1024)}kb has been deleted from local buffer`),E=E.filter(e=>u!==e.idpage),c-=f,T-=s.length,P-=l,X(H()+l),c+t>r?(L(c),o.continue()):(L(c+t),$(q(n,i)),C=setInterval(Y,1e3))}),s.addEventListener("error",()=>Object(a.notify)("error","Error trying to parse db with cursor API"))}(r,t,e,n)):"offload"===o.Config.bufferRecording&&(Object(a.notify)("warn","local buffer reached its limit --\x3e transitioning to websocket"),D()),b({bufferedSize:r,bufferedEvents:T,bufferedPis:P,bufferedDiscardedPis:H()})}function $(e){F(k).put(e).addEventListener("error",()=>{Object(a.notify)("error","error storing page")})}function q(e,t){let n=E.find(e=>e.idpage===O);return n||(n={idpage:O,events:[],piCount:0},E.push(n)),n.events=n.events.concat(e),n.lastActivity=Date.now(),n.piCount+=t,P+=t,n}let B,K,J=!1,G=0,Z=!1,Q=String.fromCharCode(0),ee=String.fromCharCode(1),te=[],ne=null,oe=0;function ie(){J||(window.addEventListener("beforeunload",ae),J=!0),o.State.recordingToBuffer?(Object(a.notify)("Recording events to local buffer."),o.State.socketStatus="buffer",x()):re()}function re(){if("open"===o.State.socketStatus||"pending"===o.State.socketStatus)return;let e=`wss://${o.Config.trackingServerHost}/ws/?vid=${Object(o.getVid)()}`;"initial"===o.State.socketStatus&&(o.State.socketStatus="pending",Object(a.notify)("connecting websocket to "+e)),"reconnect"===o.State.socketStatus&&Object(a.notify)("reconnecting websocket to "+e);try{B=new WebSocket(e),B.onopen=ue,B.onclose=le,B.onmessage=de,B.onerror=fe}catch(e){Object(a.notify)("socket failed to connect",e)}G++}function ae(){if(B&&"open"===o.State.socketStatus){!function(){for(;te[0];)ge(te.shift())}(),o.State.socketStatus="closed",Object(a.notify)("closing socket");try{B.close()}catch(e){Object(a.notify)("error while closing socket",e)}o.Events.dispatch("socket_closed"),clearInterval(K)}}function ce(e){o.State.recordingToBuffer?function(e){j.push(e)}(e):(te.push(e),pe())}function se(e){return 15===e[0]&&e[2].length>=o.Config.compressionSizeMin&&e[2].length<=o.Config.compressionSizeMax&&"{"===e[2][0]?e[2]=s(e[2]):14===e[0]&&e[1].length>=o.Config.compressionSizeMin/5&&e[1].length<=o.Config.compressionSizeMax/5&&"{"===e[1][0]&&(e[1]=s(e[1])),e}function ue(){o.State.nativeCompressionSupported="string"==typeof B.extensions&&!!~B.extensions.indexOf("permessage-deflate"),B.send("MTP/1.0\n"+Q),"reconnect"===o.State.socketStatus?st("reconnect",{PID:o.State.currentPID}):st("connectTime",{clientTime:+Date.now()}),o.State.socketStatus="open",o.Events.dispatch("socket_open"),G=0,Z&&o.Events.dispatch("socket_switched_server"),K=setInterval(()=>{"recording"===o.State.trackingStatus&&st("ping")},6e4),pe()}function le(){return"closed"===o.State.socketStatus?(o.State.socketStatus="initial",void("stopped"!==o.State.trackingStatus&&It())):G>30?(Object(a.notify)("warn","maximal count of socket reconnect tries reached. stopping tracking"),void It()):(o.State.socketStatus="reconnect",G%3==2&&(o.State.serverOffset++,Z=!0),void setTimeout(ie,500))}function de({data:e}){if(e&&"string"==typeof e&&e.length)switch(e=e.split(ee),Object(a.notify)("socket server response: "+e.join("·")),e[0]){case"7":e.length>2&&!isNaN(e[2])&&+e[2]?It(!0):It()}}function fe(e){Object(a.notify)("warn","socket error",e)}function pe(){if(!B||B.readyState!==WebSocket.OPEN||0===te.length)return;let e=performance.now();null===ne&&(ne=e),e-ne>50?setTimeout((function(){ne=null,pe()}),1):(ge(te.shift()),pe())}function ge(e){o.State.debug||o.State.nativeCompressionSupported||se(e);try{B.send(e.join(ee)+ee+Q),oe=0}catch(t){if(oe++,oe>1)return;te.unshift(e),Object(a.sendStatsRequest)({type:"error",msg:"WebSocket Error (socket.send Exception); Exception: "+t,line:"0:0",script_url:"mpathy.js"})}}let me,he={},be=-1,ye=-1,ve=["onload","onunload","onchange","onfocus","onselect","click","onmouseover","onmousemove","onmouseout","onblur","onkeydown","onkeyup","onkeypress","onenter","onsubmit","onmouseenter","onmouseleave","ontouchstart","ontouchmove","ontouchend"];function Se(){Pe(document.documentElement),function(){m("snapshot");let e=Ie(document,{recursive:!0});(o.State.consoleOpen||o.State.debug)&&(window.Mpathy.State.jsonDomdata={snapshot:e,mutations:[]});e=JSON.stringify(e),st("snapshot",{snapshot:e}),h({mutationId:"snapshot",mutationData:e})}(),me=new MutationObserver(Me),me.observe(document.documentElement,{subtree:!0,childList:!0,characterData:!0,attributes:!0})}function we(){me&&me.disconnect()}function ke(e){let t={},n=Ne(e,"maskAttributes"),o="INPUT"===e.tagName&&"password"===e.type;for(let n=0;n<e.attributes.length;n++){let o=e.attributes[n];ve.includes(o.name)||(t[o.name]=o.value)}if("INPUT"===e.tagName&&["text","email","number","radio","checkbox"].includes(e.type)&&(e.checked&&!t.hasOwnProperty("checked")&&(t.checked=""),!t.value===e.value||o||(t.value=Te(e)?Object(a.scrambleString)(e.value):e.value)),"OPTION"===e.tagName&&e.selected&&!t.hasOwnProperty("selected")&&(t.selected=""),0===e.attributes.length)return t;if(null===n&&Te(e)&&(n=["value","href","alt","title"]),Array.isArray(n)&&n.forEach(n=>{("href"!==n||"BASE"!==e.tagName&&"LINK"!==e.tagName)&&t.hasOwnProperty(n)&&(t[n]=Object(a.scrambleString)(t[n]))}),"function"==typeof n){let o=n(t,e);void 0!==o&&(t=o)}return t}function Oe(e,t){if(!e.hasAttribute(t))return null;return ke(e)[t]}function Ce(e){let t=e.textContent;return Te(e)&&(t=Object(a.scrambleString)(t)),t}function Ee(e,t){st("mutation",{data:JSON.stringify({t:[[+e,t]]}),mutationId:++ye})}function je(e,t){st("mutation",{data:JSON.stringify({at:[[+e,t]]}),mutationId:++ye})}function Ne(e,t,n=null){return e&&e.mptNodeConfig&&e.mptNodeConfig.hasOwnProperty(t)?e.mptNodeConfig[t]:n}function Te(e){let t=null;return Object(a.loopNodeTree)(e,e=>e.tagName&&"STYLE"===e.tagName.toUpperCase()?(t=!1,!1):(t=Ne(e,"maskText"),null===t&&void 0)),null===t&&(t=o.Config.maskFullPage),t}function Pe(e){Array.from(e.querySelectorAll("*")).forEach(e=>{e.mptNodeConfig={maskText:De(e),maskAttributes:null,anticlickmap:!1,ignoreAttributesMutation:null,ignoreTextMutation:!1,trackHover:!1}}),Object(a.resolveNodes)([e,".fsrVisible, [mpt-visible]"]).forEach(e=>{e.mptNodeConfig.maskText=!1}),Object(a.resolveNodes)([e,"[mpt-anon]"]).forEach(e=>{e.mptNodeConfig.maskText=!0}),Array.from(o.State.matchingScopesConfig.nodeConfig).forEach(({selector:t,config:n})=>{Object(a.resolveNodes)([e,t]).forEach(e=>{Object.assign(e.mptNodeConfig,n)})})}function Ie(e,{recursive:t=!1}={}){if(!e)return null;if(_e(e)&&!t)return{id:+e.mptNodeId};let n=++be,o={nT:e.nodeType,id:+n};switch(e.mptNodeId=n,he[n]=e,e.nodeType){case e.DOCUMENT_TYPE_NODE:o.name=e.name,o.publicId=e.publicId,o.systemId=e.systemId;break;case e.DOCUMENT_FRAGMENT_NODE:return null;case e.ELEMENT_NODE:Object.assign(o,function(e){let t={tN:e.tagName,at:ke(e)};"http://www.w3.org/2000/svg"===e.namespaceURI&&(t.ns="svg");"SCRIPT"===t.tN&&t.at.hasOwnProperty("src")&&delete t.at.src;return t}(e)),"STYLE"!==o.tN||e.textContent||(!function(e,t){let n=new Text;n.textContent=xe(e.sheet.rules),n.mptNodeConfig={maskText:!1},t.cN=[Ie(n)];let o,i=e.sheet.deleteRule,r=e.sheet.insertRule;e.sheet.deleteRule=(...t)=>{i.apply(e.sheet,t),clearTimeout(o),o=setTimeout(()=>{Ee(n.mptNodeId,xe(e.sheet.rules))},100)},e.sheet.insertRule=(...t)=>{r.apply(e.sheet,t),clearTimeout(o),o=setTimeout(()=>{Ee(n.mptNodeId,xe(e.sheet.rules))},100)}}(e,o),t=!1),"OPTION"===o.tN&&(e.mptOptionSelected=e.selected);break;case e.TEXT_NODE:Object.assign(o,function(e){let t;t=e.parentNode&&"SCRIPT"===e.parentNode.tagName?"":Ce(e);return{tC:t}}(e));break;case e.COMMENT_NODE:o.tC=e.textContent}if(t&&e.childNodes&&e.childNodes.length>0){let n=e.childNodes[0];for(o.cN=[];n;)o.cN.push(Ie(n,{recursive:t})),n=n.nextSibling}return o}function xe(e){return Array.from(e).map(e=>e.cssText).join("\n")}function Me(e){if("recording"!==o.State.trackingStatus)return;let t={am:[],r:[],t:[]},n={},i=++ye,r=[];m(i),Array.from(e).forEach(e=>{"attributes"===e.type&&(!function(e,{target:t,attributeName:n}){if(!_e(t))return;let o=Ne(t,"ignoreAttributesMutation");if(Array.isArray(o)&&o.includes(n))return;e.hasOwnProperty(t.mptNodeId)||(e[t.mptNodeId]=[]);e[t.mptNodeId].push(n)}(n,e),r.push(e.target)),"childList"===e.type&&(!function e(t,n){for(let o=0;o<n.length;o++){let i=n[o];_e(i)&&(t.r.includes(i.mptNodeId)||Re(i)!==document&&(i.nodeType===Node.ELEMENT_NODE&&e(t,i.childNodes),t.r.push(+i.mptNodeId),delete he[i.mptNodeId],i.mptOldNodeId=i.mptNodeId,delete i.mptNodeId,he.hasOwnProperty(n.mptParentId)&&(i.mptOldParentNode=he[n.mptParentId])))}}(t,e.removedNodes,e.target),function e(t,n,{target:o=null}={}){for(let i=0;i<n.length;i++){let r=n[i],c=_e(r);if(Re(r)!==document)continue;let s=c?{id:r.mptNodeId}:Ie(r);if(r.previousSibling){let n=Ae(r.previousSibling);null===n&&(e(t,[r.previousSibling],{target:o}),n=r.previousSibling.mptNodeId),s.pS={id:n}}let u=null;_e(r.parentNode)?u=Ae(r.parentNode):(_e(o)||_e(r.previousSibling))&&(u=Ae(o)),s.pN={id:u},null===s.pN.id&&Object(a.notify)("warn","added/moved node mutation has no parentId",{addedNode:r,parentNode:r.parentNode,target:o,serializedNode:s}),t.am.push(s),c||r.nodeType!==Node.ELEMENT_NODE||e(t,r.childNodes,{target:r})}}(t,e.addedNodes,{target:e.target}),r.push(e.target)),"characterData"===e.type&&function(e,{target:t}){if(Ne(t.parentNode,"ignoreTextMutation")||!_e(t))return;e.t.push([+t.mptNodeId,Ce(t)])}(t,e)}),Object.keys(n).length>0&&(t.at=function(e){return Object.keys(e).map(t=>{let n={},o=he[t];if(o){let i=ke(o);e[t].forEach(e=>{i.hasOwnProperty(e)?n[e]=i[e]:n[e]=null})}return[+t,n]})}(n)),r.length>0&&Object(a.arrayUniq)(r).forEach(e=>{e.parentNode&&Pe(e.parentNode)}),0===t.am.length&&delete t.am,0===t.r.length&&delete t.r,0===t.t.length&&delete t.t,0!==Object.keys(t).length&&((o.State.consoleOpen||o.State.debug)&&window.Mpathy.State.jsonDomdata.mutations.push(t),t=JSON.stringify(t),st("mutation",{data:t,mutationId:i}),h({mutationId:i,mutationData:t}))}function De({tagName:e,type:t}){let n=["INPUT","TEXTAREA","SELECT"].includes(e.toUpperCase());return o.Config.maskFullPage||!n||"INPUT"===e&&["button","submit","reset"].includes(t)?null:o.Config.maskAllInputs||null}function _e(e){return e&&e.hasOwnProperty("mptNodeId")}function Ae(e){return e&&e.hasOwnProperty("mptNodeId")?e.mptNodeId:null}function Re(e){let t=e;return Object(a.loopNodeTree)(e,e=>t=e),t}let Le=!1,He=location.href.replace(location.hash,""),Xe=location.hash,Fe=Date.now(),Ve=500,ze=10,Ue=2e3,We=1e4,Ye=500;function $e(){Le||(Le=!0,setInterval(Be,Ve),function(){let e=!1;window.addEventListener("pagehide",()=>{e||window.addEventListener("pageshow",t=>{(t.persisted||window.performance&&2===window.performance.navigation.type)&&("rolling"===o.Config.bufferRecording?_(!1):_t({force:!0})),e=!0})})}())}function qe(){Le&&(clearInterval(Be),Le=!1)}function Be(){let e=location.href.replace(location.hash,"");He!==e?Ge({type:"custom-url"}):Xe!==location.hash&&Ke({type:"custom-hash"}),He=e,Xe=location.hash}const Ke=Object(a.debounce)(Ge,ze),Je=Object(a.throttle)(Ge,Ue);function Ge(e){if(!e||!e.type)return void Object(a.notify)("warn","Eventhandler called without event-object");if("popstate"==e.type&&!e.state)return;let t=!1,n=Date.now(),o=n-Fe;Fe=n,["custom-url"].includes(e.type)&&(t=!0),_t(t||o>We?{force:t}:{delay:Ye})}let Ze,Qe,et,tt=!1,nt={},ot={0:1,1:4,2:2};function it(){tt||(tt=!0,rt(),o.Events.onceInitial("dom_loaded",()=>{vt(),ut().forEach(({event:e,context:t=null,args:n=[]})=>{t||(t=document),Array.isArray(e)||(e=[e]),e.forEach(e=>t.addEventListener(e,ct,...n))}),ht()}))}function rt(){o.State.merge({maxScrollHeight:Object(a.getScrollingElement)().scrollHeight,lastClickTime:null,clickEmulationRunning:!1,cursorPosition:{pageX:0,pageY:0},scrollPosition:{scrollTop:Object(a.getScrollTop)(),scrollLeft:Object(a.getScrollLeft)()},clientDimensions:{height:document.documentElement.clientHeight,width:document.documentElement.clientWidth},windowDimensions:{height:window.innerHeight,width:window.innerWidth}}),Ze={},Qe=null,et=null}function at(){ut().forEach(({event:e,context:t=null})=>{t||(t=document),Array.isArray(e)||(e=[e]),e.forEach(e=>t.removeEventListener(e,ct))}),tt=!1}function ct(e){if(/^(keydown|mouse(down|move)|touchend|scroll|resize|hashchange|popstate|pageshow)$/.test(e.type)&&function(e){["mousemove","scroll"].includes(e.type)?Je(e):Ke(e)}(e),"recording"===o.State.trackingStatus)switch(e.type){case"load":case"pageshow":case"pagehide":!function({type:e}){"pagehide"===e?st("pagehide"):st("load",{eventType:e})}(e);break;case"scroll":!function({target:e}){if(e.nodeType===Node.ELEMENT_NODE)return void st("elementScroll",{scrollLeft:e.scrollLeft,scrollTop:e.scrollTop,nodeId:e.mptNodeId||0,xPath:e.hasOwnProperty("mptNodeId")?Object(a.getElementXPath)(e):null});let t=Object(a.getScrollLeft)(),n=Object(a.getScrollTop)(),i=t-o.State.scrollPosition.scrollLeft,r=n-o.State.scrollPosition.scrollTop;if(!i&&!r)return;o.State.scrollPosition.scrollLeft=t,o.State.scrollPosition.scrollTop=n,st("scroll",{deltaScrollLeft:i,deltaScrollTop:r}),Object(a.isMobile)()&&gt();ht(),mt()}(e);break;case"focus":!function(e){let t=e.target,n=t.form;if(!["INPUT","TEXTAREA","SELECT"].includes(t.nodeName))return;let i=e.hasOwnProperty("blank_value")?"":t.value;Te(t)&&(i=Object(a.anonymizeString)(i));let r={fieldId:t.getAttribute("id")||"",fieldName:t.getAttribute("name")||"",fieldMptId:St(t)||null,fieldValue:i,fieldType:t.type,formId:null,formName:null,formMptId:null,tagName:t.tagName,XPath:Object(a.getElementXPath)(t)};n&&(r.formId=n.getAttribute("id")||"",r.formName=n.getAttribute("name")||"",r.formMptId=St(n)||null);if(o.Events.dispatch("focus",r),!r.fieldId&&!r.fieldName&&!r.fieldMptId)return;st("focus",r),Object(a.isMobile)()&&gt()}(e);break;case"blur":!function(e){let t,n=e.target;if(!["INPUT","TEXTAREA","SELECT"].includes(n.nodeName))return;switch(n.type){case"password":t="*".repeat(n.value.length);break;case"checkbox":t=+n.checked;break;case"select-one":case"select-multiple":t=Te(n)?0:n.selectedIndex;break;case"button":case"file":case"image":case"radio":case"reset":case"submit":break;default:t=n.value,Te(n)&&(t=Object(a.anonymizeString)(t))}st("blur",{fieldValue:t})}(e);break;case"change":!function(e){let t=e.target,n=t.form;if(!t)return;let o=e.hasOwnProperty("blank_value")?"":t.value;Te(t)&&(o=Object(a.anonymizeString)(o));let i={fieldId:t.getAttribute("id")||"",fieldName:t.getAttribute("name")||"",fieldMptId:St(t)||null,fieldValue:o,formId:null,formName:null,formMptId:null,tagName:t.tagName};n&&(i.formId=n.getAttribute("id")||"",i.formName=n.getAttribute("name")||"",i.formMptId=St(n)||null);st("change",i),function(e){if("INPUT"===e.tagName&&["text","email","number","radio","checkbox"].includes(e.type)){if(e.hasAttribute("checked"))return void je(e.mptNodeId,{checked:e.checked?"":null});if(e.hasAttribute("value"))return void je(e.mptNodeId,{value:Te(e)?Object(a.scrambleString)(e.value):e.value})}"TEXTAREA"===e.tagName&&Ee(e.mptNodeId,Te(e)?Object(a.scrambleString)(e.value):e.value),"SELECT"===e.tagName&&Array.from(e.childNodes).forEach(t=>{t.selected!==e.mptOptionSelected&&je(t.mptNodeId,{selected:t.selected?"":null})})}(t)}(e);break;case"resize":!function(){if(Object(a.isMobile)())return void gt();let{innerHeight:e,innerWidth:t}=window,{clientHeight:n,clientWidth:i}=document.documentElement;if(e===o.State.windowDimensions.height&&t===o.State.windowDimensions.width)return;st("resize",{clientWidth:i,clientHeight:n,windowHeight:e,windowWidth:t,deltaClientHeight:n-o.State.clientDimensions.height,deltaClientWidth:i-o.State.clientDimensions.width,deltaWindowHeight:e-o.State.windowDimensions.height,deltaWindowWidth:t-o.State.windowDimensions.width}),o.State.clientDimensions.height=n,o.State.clientDimensions.width=i,o.State.windowDimensions.height=e,o.State.windowDimensions.width=t,ht()}();break;case"mousedown":lt(e);break;case"keydown":!function(e){if([16,17,18,91,93,224].indexOf(e.keyCode)>-1)return;let{keyCode:t,key:n}=function({target:e,keyCode:t,key:n=""}){switch(n=String(n)){case"Down":n="ArrowDown";break;case"Up":n="ArrowUp";break;case"Left":n="ArrowLeft";break;case"Right":n="ArrowRight";break;case"Esc":n="Escape"}"INPUT"===e.tagName&&"password"===e.type&&(t=106,n="*");if(!Te(e))return{keyCode:t,key:n};/^(6[3-9]|[78]\d|90)$/.test(t)?(t=88,n="X"):/^(49|5[0-7]|9[6-9]|10[0-5])$/.test(t)&&(t=48,n="0");return{keyCode:t,key:n}}(e);st("keydown",{modKey:ft(e),keyCode:t,key:n})}(e);break;case"touchstart":case"touchend":case"touchmove":case"touchcancel":!function(e){let t=e.type;Array.from(e.changedTouches||[]).forEach(n=>{let i=n.identifier,r=Ze[t]||{};if("touchmove"===t&&r[i]&&r[i].screenX===n.screenX&&r[i].screenY===n.screenY)return;Ze.hasOwnProperty(t)||(Ze[t]={}),Ze[t][i]={screenX:n.screenX,screenY:n.screenY};let c={fingerId:i,screenX:Math.round(n.screenX),screenY:Math.round(n.screenY),pageX:Math.round(n.pageX),pageY:Math.round(n.pageY),clientX:Math.round(n.clientX),clientY:Math.round(n.clientY)};return["touchstart","touchmove"].includes(t)&&(c={...c,force:Math.round(100*(n.force||0)),angle:n.rotationAngle||0,radiusX:Math.round(n.radiusX||0),radiusY:Math.round(n.radiusY||0)}),"touchstart"===t&&(c={...c,tagName:n.target.tagName,id:Oe(n.target,"id"),href:n.target.href||"",anticlickmap:+dt(n.target),xpath:Object(a.getElementXPath)(n.target)}),("touchend"===t||"touchmove"===t&&window.pageYOffset<5)&&gt(),st(t,c),function(e,t,n){if(clearTimeout(nt.clickEmulate),"touchstart"===t.type){if(1!==t.touches.length)return o.State.clickEmulationRunning=!1,void(Qe=null);o.State.clickEmulationRunning=+Date.now(),Qe={target:e.target,button:0,el_rel_coords:pt(e.target,e.clientX,e.clientY),el_dimensions:Object(a.getNodeDimensions)(e.target),clientX:e.clientX,clientY:e.clientY,pageX:e.pageX,pageY:e.pageY,anticlickmap:n.anticlickmap,xPath:n.xpath}}"touchmove"!==t.type&&"touchcancel"!==t.type||(o.State.clickEmulationRunning=!1,Qe=null);"touchend"===t.type&&setTimeout((function(){if(o.State.clickEmulationRunning){let e=+Date.now()-o.State.lastClickTime,t=+Date.now()-o.State.clickEmulationRunning;e>50&&t<700&&lt({type:"mousedown",emulated:!0})}o.State.clickEmulationRunning=!1,Qe=null}),25)}(n,e,c),c})}(e);break;case"gesturestart":case"gesturechange":case"gestureend":!function({type:e,scale:t,rotation:n,target:o}){let i={scale:t,rotation:n};"gesturestart"===e&&(i.tagName=o.tagName,i.nodeId=Oe(o,"id"));st(e,i)}(e);break;case"orientationchange":gt(),st("orientationChange",{orientation:Object(a.getOrientation)()});break;case"mousemove":!function({pageX:e,pageY:t}){if(e===o.State.cursorPosition.pageX&&t===o.State.cursorPosition.pageY)return;st("mousemove",{buttonId:0,modKey:0,pageX:Math.round(e-o.State.cursorPosition.pageX),pageY:Math.round(t-o.State.cursorPosition.pageY)}),o.State.cursorPosition={pageX:e,pageY:t}}(e);break;case"mouseover":case"mouseout":!function(e){if(!(null!==e&&"object"==typeof e&&e.target&&e.target instanceof Element))return;let t=e.target;if("mouseover"===e.type)for(bt(t);t;)bt(t),t=t.parentNode;else{let n=e.relatedTarget||e.toElement;for(yt(t,n);t;)yt(t,n),t=t.parentNode}}(e)}}function st(e,t={}){if(!r.hasOwnProperty(e))return void Object(a.notify)("error","Unknown Event Type: "+e);let n=Mt(),o=r[e];return!1!==o.logLevel&&Object(a.notify)(o.logLevel||"debug",`Event ${e} at ${n}ms`,t),t={type:o.id,time:n,...t},ce((r[e].dataOrder||["type"]).map(e=>t.hasOwnProperty(e)?"boolean"==typeof t[e]?+t[e]:t[e]:e)),t}function ut(){let e=[];return e.push({event:["load","pageshow","pagehide","hashchange","popstate"]}),e.push({event:["scroll","focus","blur","change"],args:[!0]}),e.push({event:"resize",context:window}),e.push({event:"mousedown"}),o.Config.recordKeyEvents&&e.push({event:"keydown"}),Object(a.isTouchDevice)()?(e.push({event:["touchstart","touchend","touchmove","touchcancel"]}),e.push({event:["gesturestart","gesturechange","gestureend"]}),e.push({event:"orientationchange",context:window})):(e.push({event:"mousemove"}),e.push({event:["mouseover","mouseout"],args:[!0]})),e}function lt(e){if(o.State.lastClickTime=+Date.now(),Object(a.isTouchDevice)()){if(window.clearTimeout(nt.clickEmulate),o.State.clickEmulationRunning){if(null===Qe&&e.emulated)return;e=Object.assign({},e,Qe)}o.State.clickEmulationRunning=!1}let{target:t,pageX:n,pageY:i,button:r}=e;if(!t)return;if(!("OPTION"!==t.tagName||n&&i))return;let c={buttonId:ot[r],modKey:ft(e),pageX:Math.round(n),pageY:Math.round(i)},s=e.elementDimensions||Object(a.getNodeDimensions)(t),u=e.elemenRelCoords||pt(t,e.clientX,e.clientY),l=function(e){let t=[];for(;e&&e!=document;){let n=e.hasOwnProperty("mptClickableChild")?e.mptClickableChild.rect:Object(a.getNodeDimensions)(e),o=e.hasOwnProperty("mptOldParentNode")?e.mptOldParentNode:e.parentNode;o&&document&&document.Element&&o instanceof document.Element&&(n.left=n.left-parseInt(document.getComputedStyle(o).getPropertyValue("text-indent"))),n.width=e.offsetWidth||n.width,n.height=e.offsetHeight||n.height,t.push(n),e=o}return t}(t),d=e.xPath||Object(a.getElementXPath)(t);if(u.x<0||u.y<0||u.x>s.width||u.y>s.height){s.width=200,s.height=200;let e=Math.floor(u.x/s.width)*s.width,t=Math.floor(u.y/s.width)*s.width;u.x=u.x-e,u.y=u.y-t,l.unshift({left:s.left+e,top:s.top+t,width:s.width,height:s.width}),d+="/MPTHIDDEN"+e+"X"+t+"[1]"}let f=function(e){let t=[];return Array.from(e).forEach((n,o)=>{let i=e.length>o+1?e[o+1]:null,r=[n.width,n.height,n.left,n.top,0,0,1,0];i&&(r[4]=n.left-i.left,r[5]=n.top-i.top,i.width>0&&n.width>0&&(r[6]=n.width/i.width,r[7]=(i.left+.5*i.width-(.5*n.width+n.left))/(.5*n.width)),r[6]!==Math.ceil(r[6])&&(r[6]=r[6].toFixed(5)),r[7]!==Math.ceil(r[7])&&(r[7]=r[7].toFixed(5))),t.unshift(r.join(";"))}),t.join("/")}(l),p=dt(t);p||"SELECT"!==t.tagName||(p=u.y<-4||u.y>s.height+4),st("mousedown",{...c,tagName:t.tagName,id:Oe(t,"id"),href:t.href||"",anticlickmap:+p,xpath:d,position:Math.round(u.x)+","+Math.round(u.y),dimensions:Math.round(s.width)+","+Math.round(s.height),dimensionPath:f}),o.State.cursorPosition={pageX:n,pageY:i}}function dt(e){let t=!1;return Object(a.loopNodeTree)(e,e=>{if(Ne(e,"anticlickmap"))return t=!0,!1}),t}function ft({ctrlKey:e,altKey:t,shiftKey:n,metaKey:o}){return(e?1:0)+(t?2:0)+(n?4:0)+(o?8:0)}function pt(e,t,n){let o=Object(a.getNodeDimensions)(e),i=e.hasOwnProperty("mptOldParentNode")?e.mptOldParentNode:e.parentNode,r=window.getComputedStyle(e).getPropertyValue("position");return i&&i instanceof Element&&["absolute","relative","fixed"].includes(r)&&(o.left=o.left-parseInt(window.getComputedStyle(i).getPropertyValue("text-indent"))),{x:Math.round(t-o.left),y:Math.round(n-o.top)}}const gt=Object(a.debounce)(()=>{st("scaleChange",{innerWidth:window.innerWidth,innerHeight:window.innerHeight,clientWidth:document.documentElement.clientWidth,pageXOffset:window.pageXOffset,pageYOffset:window.pageYOffset})},100),mt=Object(a.debounce)(()=>{let{scrollHeight:e}=Object(a.getScrollingElement)();e>o.State.maxScrollHeight&&(st("scrollHeight",{scrollHeight:e}),o.State.maxScrollHeight=e)},1e3),ht=Object(a.debounce)(()=>{let e=Object(a.getScrollTop)(),t=Math.ceil(e/50),n=Math.floor((e+document.documentElement.clientHeight)/50)-t,o=t+";"+n;o!==et&&(st("areaVisibility",{firstArea:t,countAreas:n}),et=o)},500);function bt(e){Ne(e,"trackHover")&&!e.mptSimulateHover&&(je(e.mptNodeId,{"mpt-hover":""}),e.mptSimulateHover=!0)}function yt(e,t){if(Ne(e,"trackHover")&&e.mptSimulateHover){for(;t;){if(t===e)return;t=t.parentNode}je(e.mptNodeId,{"mpt-hover":null}),delete e.mptSimulateHover}}function vt(){"string"==typeof o.Config.clickableElements&&Object(a.resolveNodes)(o.Config.clickableElements).forEach(e=>{let t={};Array.from(e.children).forEach(e=>{t[e.tagName]=(t[e.tagName]||0)+1,e.mptClickableChild={index:t[e.tagName],rect:Object(a.getNodeDimensions)(e)}})}),setTimeout(vt,500)}function St(e){let t=e.getAttribute("mptid");if(t)return t;if("FORM"===e.nodeName){let n=Array.from(document.forms||[]).findIndex(t=>e===t);return~n&&e.setAttribute("mptid",n),t}let n=e.form||null,o=n?n.elements:document.getElementsByTagName(e.tagName),i=Array.from(o).findIndex(t=>t===e);return t=`${e.tagName};${function(e){if(null==e)return null;if(e.getAttribute("name"))return"name:"+e.getAttribute("name");if(e.getAttribute("id"))return"id:"+e.getAttribute("id");return"mptid:"+St(e)}(n)};${i}`,e.setAttribute("mptid",t),t}var wt=n(6);let kt=!1,Ot=!1;const Ct={},Et={};function jt(){Ot||(!function(){if(o.Config.enableTEOLogging){g=!0;try{let e=localStorage.getItem("mpt_teo_stats");e&&y(JSON.parse(e))}catch(e){Object(a.notify)("warn","Could not parse preserved TEO Stats from last PI: "+e)}localStorage.removeItem("mpt_teo_stats"),window.addEventListener("beforeunload",v)}}(),Object(wt.subscribeFrameBridge)("xVid",(e,t)=>{kt||(At("x-vid",e.VID,{scope:"session"}),kt=!0),e.receivedXVid||Object(wt.emitFrameBridge)("xVid",{VID:Object(o.getVid)(),receivedXVid:kt},t.source)}),Object(wt.emitFrameBridge)("xVid",{VID:Object(o.getVid)(),receivedXVid:kt}),Ot=!0,Object(a.notify)("info","Engine ready"),o.Events.dispatch("tracking_ready",null,{target:window}),o.State.trackingStatus="ready",o.Config.autostartTracking&&Nt())}function Nt(){if("resolved"!==o.State.precheckStatus)return;null!==Object(i.getPagename)()&&_t({force:!0}),$e()}function Tt(){Ot||(o.Config.bufferRecording&&null===o.State.recordingToBuffer&&(o.State.recordingToBuffer=!0,Object(u.setCookie)("recording_to_buffer_"+o.Config.idsite,1,"session_timeout")),o.State.conditionalImport=!0,Object(u.setCookie)("conditional_import_"+o.Config.idsite,1,"session_timeout"),o.Config.autostartTracking=!0,Object(i.setTrackingActiveCookie)(!0,"session_timeout"),jt())}function Pt(){let e=o.State.trackingStatus;o.State.trackingStatus="paused",o.State.previousPID=null,"recording"===e&&(we(),Rt(),Object(a.notify)("⏸️ %cPaused Tracking","color: blue; font-weight: bold"))}function It(e=!1){let t=o.State.trackingStatus;o.State.trackingStatus="stopped",o.State.previousPID=null,"recording"===t&&(we(),at(),qe(),Rt(),ae()),"paused"===t&&(at(),qe(),ae()),e?(Object(a.notify)("🛑 %cStopped Tracking (session)","color: red; font-weight: bold"),Object(u.setCookie)("tracking_stopped_"+o.Config.idsite,1,"session"),Object(i.setTrackingActiveCookie)(!1),A()):Object(a.notify)("⚠️ %cStopped Tracking","color: orange; font-weight: bold")}function xt(e="default"){["recording","paused"].includes(o.State.trackingStatus)&&(o.State.recordingToBuffer&&D(),Object(a.notify)("%c✔️ Session has been flagged for import!","color: green"),st("activateSession",{recordingType:e}))}function Mt(){return o.State.piStartTime?+Date.now()-o.State.piStartTime:null}function Dt(e){return o.Config.maskUrl instanceof RegExp?e=Object(a.anonymizeString)(e,o.Config.maskUrl):"function"==typeof o.Config.maskUrl?e=o.Config.maskUrl(e,a.anonymizeString):o.Config.maskUrl&&"string"==typeof o.Config.maskUrl&&(e=Object(a.anonymizeString)(e,new RegExp(o.Config.maskUrl))),e}function _t({delay:e=null,force:t=!1}={}){if("stopped"===o.State.trackingStatus)return;if(o.Config.stopOnTranslation&&null!==document.querySelector(".translated-ltr, .translated-rtl"))return It(!0),void Object(a.notify)("warn","tracking stopped. translator detected.");if(window.innerHeight<50||window.innerWidth<50)return void Object(a.notify)("warn","tracking stopped. Viewport to small.");if(null!==e)return clearTimeout(Ct.checkPI),void(Ct.checkPI=setTimeout(()=>_t({force:t}),e));let n=+Date.now()-o.State.piStartTime;if(n<1e3)return _t({delay:1e3-n,force:t});if(function(){if(o.Events.dispatch("delay_pi",!1))return!0;if(o.State.clickEmulationRunning)return!0;let{activeElement:e}=document;if(e&&o.Config.piCheckActiveElement&&null!==o.State.currentPID){if("INPUT"===e.tagName&&!["radio","checkbox","button","submit"].includes(e.type))return!0;if(["TEXTAREA","SELECT"].includes(e.tagName))return!0}return!1}())return _t({delay:500,force:t});let r=o.State.pagename,c=Object(i.getPagename)();if(null===c)return void("recording"===o.State.trackingStatus&&Pt());!function(){let e={pagenameModifier:[],properties:[],nodeConfig:[]};o.State.scopes.forEach(t=>{if(t.isMatching(!0)){let n=t.config;e.pagenameModifier=e.pagenameModifier.concat(n.pagenameModifier),e.properties=e.properties.concat(n.properties),e.nodeConfig=e.nodeConfig.concat(n.nodeConfig)}}),o.State.matchingScopesConfig=e}();let s=function(e){return e.map(({valueCallback:e,...t})=>(t.value="function"==typeof e?e():e,t))}(o.State.matchingScopesConfig.properties),u=function(e){return e.filter(({overwrite:e,name:t,value:n})=>{if(!e)return!1;let o=n!==Et[t];return Et[t]=n,o})}(s),f=function(e){return e.filter(({overwrite:e})=>!e).map(({name:e,value:t})=>(Array.isArray(t)&&(t=t.join("&")),`${e}:${t}`)).join("\n")}(s);t||r!==c||o.State.propertiesHash!==f?(o.State.propertiesHash=f,function(e){let t="recording"===o.State.trackingStatus;o.State.trackingStatus="recording","initial"===o.State.socketStatus&&(o.State.consoleOpen&&!o.State.consoleSendData||ie());o.Config.enableTEOLogging&&o.State.currentPID&&(y(),function(){let e={...l};d.forEach(t=>delete e[t]),p={...p,...e}}());o.Events.dispatch("before_pi",{pagename:e}),o.State.currentPID&&(Rt(),rt());o.State.currentPID=function(){return String(Date.now())+String(Math.floor(9e5*Math.random())+1e5)}(),o.State.pagename=e,Object(a.notify)("info","▶️ %cnewPI: "+e,"color: blue; font-weight: bold"),t||(M(o.State.currentPID),it());o.State.piStartTime=+Date.now(),st("init",function(e){let t={charset:document.characterSet,client_height:Object(a.getClientHeight)(),con_stats:{},is_iframe:+(parent!=window),is_mutation_stream:1,is_scrolling_disabled:+Object(a.isScrollingDisabled)(),is_new_websdk:!0,is_modern_browser:window._mpt_modern||!1,unmapped_pagename:+o.State.isUnmappedPagename,initial_referer:o.State.initialReferer||"",orientation:Object(a.getOrientation)(),prev_pageid:o.State.previousPID||0,custom_scrolling_element_xpath:null,scroll_left:o.State.scrollPosition.scrollLeft,conditional_import:o.State.conditionalImport,vendors:{}};return{revision:101,idsite:o.Config.idsite,VID:Object(o.getVid)(),PID:o.State.currentPID,starttime:o.State.piStartTime,pagename:o.State.pagename,virtualPi:e,url:Dt(location.href),referer:Dt(document.referrer),ua:navigator.userAgent,locale:navigator.language,domloadTime:o.State.domloadTime,versions:Object(a.getVersionsString)(),clientWidth:Object(a.getClientWidth)(),scrollHeight:o.State.maxScrollHeight,scrollWidth:Math.max(document.body.scrollWidth,document.documentElement.scrollWidth),scrollTop:o.State.scrollPosition.scrollTop,viewport:window.innerWidth+"x"+window.innerHeight,res:screen.width+"x"+screen.height,outerViewport:(window.outerWidth||0)+"x"+(window.outerHeight||0),availableViewport:screen.availWidth+"x"+screen.availHeight,isTouch:Object(a.isTouchDevice)(),extendedProperties:JSON.stringify(t),trackingPersistence:"visit",debugMessages:"",flashVer:0,enginePolls:0}}(t)),t||Se();o.Events.dispatch("after_pi",{pagename:e})}(c),null===o.State.previousPID&&s.push({name:"engine.time.load",value:o.State.loadTime-window._mptt,type:"int"}),s.forEach(({name:e,value:t,...n})=>{Array.isArray(t)?(n.unique=!1,t.forEach(t=>At(e,t,n))):At(e,t,n)}),o.Events.dispatch("property_change",{properties:s})):u.forEach(({name:e,value:t,...n})=>At(e,t,n))}function At(e,t,{type:n="string",session:o=!1,unique:i=!0}={}){null!=t&&(Array.isArray(t)?t.forEach(t=>{At(e,t,{type:n,session:o,unique:!1})}):st("property",{name:e,value:t,scope:o?0:2,dataType:n,unique:i}))}function Rt(){o.State.previousPID=o.State.currentPID,o.State.currentPID=null,o.State.pagename=null,o.State.piStartTime=0}},function(e,t,n){"use strict";n.r(t),n.d(t,"applyMatcher",(function(){return a})),n.d(t,"pagename",(function(){return c})),n.d(t,"url",(function(){return s})),n.d(t,"conditions",(function(){return u})),n.d(t,"visible",(function(){return l})),n.d(t,"exists",(function(){return d})),n.d(t,"contains",(function(){return f})),n.d(t,"all",(function(){return p})),n.d(t,"any",(function(){return g})),n.d(t,"not",(function(){return m}));var o=n(0),i=n(1),r=n(7);function a(e){return"function"==typeof e?e():!!e}function c(e){return()=>Object(i.matchString)(e,o.State.pagename)}function s(e){return()=>e instanceof RegExp?Object(r.a)({type:"url",comparator:"regexp",value:e}):Object(r.a)({type:"url",comparator:"exact",value:e})}function u(e,t){if(!t.length)return()=>!0;return(e?p:g)(t.map(e=>()=>Object(r.a)(e)))}function l(e){return()=>Object(i.isVisible)(e)}function d(e){return()=>Object(i.resolveNodes)(e).length>0}function f(e,t){return()=>Object(i.resolveNodes)(e).some(e=>Object(i.matchString)(t,e.textContent))}function p(e){return()=>e.every(a)}function g(e){return()=>e.some(a)}function m(e){return()=>!a(e)}},function(e,t,n){"use strict";n.r(t),n.d(t,"startFrameBridge",(function(){return i})),n.d(t,"subscribeFrameBridge",(function(){return r})),n.d(t,"unsubscribeFrameBridge",(function(){return a})),n.d(t,"emitFrameBridge",(function(){return c}));let o=[];function i(){window.addEventListener("message",u)}function r(e,t){return o.push({event:e,callback:t}),()=>a(e,t)}function a(e,t){let n=o.find(n=>n.event===e&&n.callback===t);~n&&o.splice(n,1)}function c(e,t={},n=null){let o={mptEvent:e,payload:t};"function"==typeof n&&(n=n()),null===n?parent===window?Array.from(document.querySelectorAll("iframe")).forEach(e=>{e.contentWindow&&s(e.contentWindow,o)}):s(parent.window,o):s(n,o)}function s(e,t){try{e&&e.postMessage(t,"*")}catch(t){window.console&&window.console.error("error while sending post message",t,e)}}function u(e){let t=e.data;t instanceof Object&&t.hasOwnProperty("mptEvent")&&o.forEach(n=>{n.event===t.mptEvent&&n.callback(t.payload,e)})}},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var o=n(1),i=n(0);function r(e){return"object"==typeof e&&("url"===e.type?function(e,t){let n=location.pathname,i=n+location.search,r=i+location.hash,c=[n,i,r];"regexp"!==e&&(t=(t||"").replace(/^(https?:)?\/\//,""));let s=/^www\./.test(t),u=/^www\./.test(location.host);s&&!u&&(c.push("www."+location.host+n),c.push("www."+location.host+i),c.push("www."+location.host+r));if(!s&&u){let e=location.host.replace(/^www\./,"");c.push(e+n),c.push(e+i),c.push(e+r)}return c.push(location.host+n),c.push(location.host+i),c.push(location.host+r),Object(o.arrayUniq)(c).some(n=>a(e,t,n))}(e.comparator,e.value):"pagename"===e.type?(t=e.comparator,n=e.value,a(t,n,i.State.pagename)):"selector"===e.type?function(e,t,n){if("visible"===t)return Object(o.isVisible)(e);let i=Object(o.resolveNodes)(e);if("exists"===t)return i.length>0;return i.some(e=>a(t,n,e.textContent))}(e.selector,e.comparator,e.value):"useragent"!==e.type||function(e,t){if("regexp"===e){return new RegExp(t).test(navigator.userAgent)}if("contains"===e)return navigator.userAgent.includes(t);if("exact"===e)return navigator.userAgent===t}(e.comparator,e.value));var t,n}function a(e,t,n){if("regexp"===e){return new RegExp(t).test(n)}return"contains"===e?n.includes(t):"start_with"===e?n.startsWith(t):"exact"===e?n===t:void 0}},function(e,t,n){"use strict";n.r(t),n.d(t,"yesno",(function(){return r})),n.d(t,"count",(function(){return a})),n.d(t,"extractNumber",(function(){return c})),n.d(t,"extractText",(function(){return s})),n.d(t,"breakpoint",(function(){return u})),n.d(t,"multiple",(function(){return l}));var o=n(0),i=n(5);function r(e,t,n){return function(){return(e instanceof Function?e():e)?t||o.Config.propertyYesValue:n||o.Config.propertyNoValue}}function a(e,t=0){return function(){return document.querySelectorAll(e).length+t}}function c(e,t=null,n="."){return function(){t=null===t?t:Number(t);let o=document.querySelector(e);if(!o)return t;let i=o.textContent;return n&&"."!==n&&(i=i.replace(n,".")),i=Number(i.replace(/[^0-9.]+/g,"")),Number.isNaN(i)?t:i}}function s(e,t="",n){return function(){let o=document.querySelector(e),i=o?o.textContent:"";if(i&&n instanceof RegExp){let e=n.exec(i);i=Array.isArray(e)?e.length>1?e.slice(1).join(""):e[0]:""}return i||t}}function u(e){return function(){let t=window.innerWidth,n=e.find((function(e){return!(void 0!==e.min&&t<e.min)&&!(void 0!==e.max&&t>e.max)}));return n&&n.name||null}}function l(e,t=""){return function(){let n=e.find(e=>("string"!=typeof e.selector||Array.isArray(e.conditions)||(e.conditions=[{type:"selector",selector:e.selector,comparator:"exists"}],e.matchAll=!0),Object(i.conditions)(e.matchAll,e.conditions)()));return n&&n.value||t}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return c})),n.d(t,"b",(function(){return s}));var o=n(0),i=n(4),r=n(3);let a;function c(){if(o.Config.foreseeIntegration||o.Config.opinionlabIntegration)return"object"==typeof window.OOo&&o.Config.opinionlabIntegration?(Object(r.addScope)(r.Matcher.pagename(/.*/),e=>{e.addPagenameModifier("OpinionLab Survey",r.Matcher.visible(".oo_cc_wrapper"),!0)}),Object(i.startConditionalRecording)(),void window.addEventListener("OL_CC_Launch",()=>Object(i.activateSession)("opinionlab"))):"function"==typeof window.fsReady&&o.Config.foreseeIntegration?function(){if(!o.Config.hasForeseeTrigger&&!o.Config.hasForeseeFeedback)return;Object(r.addScope)(r.Matcher.pagename(/.*/),e=>{e.addPagenameModifier("Foresee Feedback",r.Matcher.visible("#acsModalContent"),!0),e.addPagenameModifier("Foresee Invite",r.Matcher.visible("#fsrInvite"),!0)}),window.fsReady(()=>{a=window.FSR,Object(i.startConditionalRecording)(),u("onFeedbackReady",{callback(){"stopped"!==o.State.trackingStatus&&l()},checkDidFire:!0}),u("onFeedbackShown",{callback(){"stopped"!==o.State.trackingStatus&&(l(),Object(i.activateSession)())}}),u("onInviteShown",{callback(){"stopped"!==o.State.trackingStatus&&l()},checkDidFire:!0}),u("onInviteAccepted",{callback(){"stopped"!==o.State.trackingStatus&&(l(),Object(i.activateSession)())},checkDidFire:!0}),u("onProductsDisqualified",{callback(){Object(i.stopTracking)(!0)},checkDidFire:!0})})}():void setTimeout(c,50)}function s(){return{idsite:o.Config.idsite,idpage:o.State.currentPID,idvisitor:Object(o.getVid)(),insightUrl:d(),replayUrl:f()}}function u(e,{callback:t,checkDidFire:n=!1}={}){"object"==typeof a[e]&&(n&&a[e].didFire&&t(),a[e].subscribe(t))}function l(){"recording"===o.State.trackingStatus&&(a.CPPS.set("mpathy_idsite",o.Config.idsite),a.CPPS.set("mpathy_idpage",o.State.currentPID),a.CPPS.set("mpathy_idvisitor",Object(o.getVid)()))}function d(){return`https://cxsuite${p()}.foresee.com/mpathy/insight/site/${o.Config.idsite}/idpage/${o.State.currentPID}`}function f(){return`https://cxsuite${p()}.foresee.com/mpathy/replay/player?idsite=${o.Config.idsite}&idpage=${o.State.currentPID}`}function p(){let e=o.Config.cdnHost.match(/^(dev-|qa-|stg-)/);return e&&"-"+e[0].slice(0,-1)||""}},function(e){e.exports=JSON.parse('{"load":{"id":1,"dataOrder":["type","eventType","time"]},"connectTime":{"id":2,"dataOrder":["type","clientTime",null,"time"]},"resize":{"id":3,"dataOrder":["type","deltaWindowWidth","deltaWindowHeight","time","deltaClientWidth","deltaClientHeight","windowWidth","windowHeight","clientWidth","clientHeight"]},"scroll":{"id":4,"dataOrder":["type","deltaScrollLeft","deltaScrollTop","time"],"logLevel":false},"scaleChange":{"id":6,"dataOrder":["type","innerWidth","innerHeight","time",0,0,"clientWidth","pageXOffset","pageYOffset"]},"mousedown":{"id":7,"dataOrder":["type","buttonId","modKey","pageX","pageY","time","tagName","id","href","anticlickmap","xpath","position","dimensions","dimensionPath"]},"elementScroll":{"id":8,"dataOrder":["type","scrollLeft","scrollTop","time","nodeId","xPath"]},"mousemove":{"id":9,"dataOrder":["type","buttonId","modKey","pageX","pageY","time"],"logLevel":false},"property":{"id":10,"dataOrder":["type","name","value","time","scope","dataType","unique"],"logLevel":"log"},"keydown":{"id":11,"dataOrder":["type","keyCode","modKey","time","key"]},"orientationChange":{"id":12,"dataOrder":["type","orientation",null,"time"]},"init":{"id":13,"dataOrder":["type","revision","PID","VID","idsite","starttime","url","viewport","res","scrollHeight","referer","flashVer","enginePolls","ua","domloadTime","scrollWidth","locale","clientWidth","pagename","scrollTop","versions","debugMessages","virtualPi","outerViewport","availableViewport","isTouch","extendedProperties","trackingPersistence"]},"mutation":{"id":14,"dataOrder":["type","data","mutationId","time"],"logLevel":false},"snapshot":{"id":15,"dataOrder":["type","0","snapshot","time"],"logLevel":false},"reconnect":{"id":16,"dataOrder":["type","PID","time"]},"ping":{"id":17,"dataOrder":["type"],"logLevel":false},"blur":{"id":18,"dataOrder":["type","fieldValue",null,"time"]},"focus":{"id":19,"dataOrder":["type","fieldId","fieldName","time","formId","fieldValue","fieldMptId","formName","formMptId","fieldType","tagName","XPath"]},"pagehide":{"id":21,"dataOrder":["type",null,null,"time"]},"areaVisibility":{"id":27,"dataOrder":["type","firstArea","countAreas","time"]},"change":{"id":30,"dataOrder":["type","fieldId","fieldName","time","formId","fieldValue","fieldMptId","formName","formMptId","tagName"]},"touchstart":{"id":32,"dataOrder":["type","fingerId","screenX","time","screenY","pageX","pageY","clientX","clientY","force","angle","radiusX","radiusY","tagName","id","href","anticlickmap","xpath"]},"touchmove":{"id":33,"dataOrder":["type","fingerId","screenX","time","screenY","pageX","pageY","clientX","clientY","force","angle","radiusX","radiusY"],"logLevel":false},"touchend":{"id":34,"dataOrder":["type","fingerId","screenX","time","screenY","pageX","pageY","clientX","clientY"]},"touchcancel":{"id":35,"dataOrder":["type","fingerId","screenX","time","screenY","pageX","pageY","clientX","clientY"]},"gesturestart":{"id":36,"dataOrder":["type","scale","rotation","time","tagName","nodeId"]},"gesturechange":{"id":37,"dataOrder":["type","scale","rotation","time"]},"gestureend":{"id":38,"dataOrder":["type","scale","rotation","time"]},"scrollHeight":{"id":40,"dataOrder":["type","scrollHeight","time"]},"activateSession":{"id":43,"dataOrder":["type","time","recordingType"]}}')}]);
//# sourceMappingURL=mpathy-modern.js.map